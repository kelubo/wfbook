# 安装

[TOC]

## 概述

Jenkins 通常在其自己的进程中作为独立应用程序运行。Jenkins WAR file bundles [Winstone](https://github.com/jenkinsci/winstone), a [Jetty](https://www.eclipse.org/jetty/) servlet container wrapper，Jenkins WAR 文件捆绑了 [Winstone](https://github.com/jenkinsci/winstone)（一种 [Jetty](https://www.eclipse.org/jetty/) servlet 容器包装器），可以在具有 Jenkins 支持的 Java 版本的任何操作系统或平台上启动。

从理论上讲，Jenkins 也可以在传统的 servlet 容器（如 [Apache Tomcat](https://tomcat.apache.org/) 或 [WildFly](https://www.wildfly.org/)）中作为 servlet 运行，但在实践中，这在很大程度上未经测试，并且存在许多注意事项。In particular, support for WebSocket agents is only implemented for the Jetty servlet container. 特别是，仅针对 Jetty servlet 容器实现对 WebSocket 代理的支持。

## 配置要求

- 最低硬件要求：
  - 256 MB 内存，建议大于 512 MB
  - 1 GB 的驱动器空间（但如果将 Jenkins 作为 Docker 容器运行，建议至少为 10 GB）
- 小型团队的推荐硬件配置：
  - 4 GB+ 的 RAM
  - 50 GB+ 的驱动器空间
- 需要安装以下软件：
  - Java：请参阅 [Java 要求](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)页面
  - Web 浏览器：请参阅 [Web 浏览器兼容性](https://www.jenkins.io/doc/administration/requirements/web-browsers/)页面
  - 对于 Windows 操作系统：[Windows 支持策略](https://www.jenkins.io/doc/administration/requirements/windows/)
  - 对于 Linux 操作系统：[Linux 支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
  - 对于 Servlet 容器：[Servlet 容器支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)

### 下载并运行 Jenkins

1. [下载 Jenkins](http://mirrors.jenkins.io/war-stable/latest/jenkins.war).
2. 打开终端进入到下载目录.
3. 运行命令 `java -jar jenkins.war --httpPort=8080`.
4. 打开浏览器进入链接 `http://localhost:8080`.
5. 按照说明完成安装.

安装完成后，您可以开始使用 Jenkins！

## Docker

[Docker](https://docs.docker.com/get-started/overview/) is a  platform for running applications in an isolated environment called a  "container" (or Docker container). Applications like Jenkins can be downloaded as read-only "images" (or  Docker images), each of which is run in Docker as a container. A Docker container is a "running instance" of a Docker image. A Docker image is stored permanently, based on when image updates are  published, whereas containers are stored temporarily.

[Docker](https://docs.docker.com/get-started/overview/) 是一个用于在称为“容器”（或 Docker 容器）的隔离环境中运行应用程序的平台。像 Jenkins 这样的应用程序可以作为只读“镜像”（或  Docker 镜像）下载，每个镜像都作为容器在 Docker 中运行。Docker 容器是 Docker 镜像的“运行实例”。Docker  映像根据映像更新的发布时间永久存储，而容器则临时存储。

Due to Docker’s fundamental platform and container design, a Docker  image for a given application, such as Jenkins, can be run on any  supported operating system or cloud service also running Docker. Supported operating systems include macOS, Linux and Windows, and  supported cloud services include AWS and Azure.

由于 Docker 的基本平台和容器设计，给定应用程序（如 Jenkins）的 Docker 映像可以在任何同样运行 Docker 的受支持操作系统或云服务上运行。支持的操作系统包括 macOS 、Linux 和 Windows ，支持的云服务包括 AWS 和 Azure 。

### 下载和运行 Jenkins

有多个 Jenkins 的 Docker 镜像可用。

使用 [Docker Hub 存储库](https://hub.docker.com/) 中推荐的官方 [`jenkins/jenkins` 镜像](https://hub.docker.com/r/jenkins/jenkins/)。此映像包含 Jenkins 的当前[长期支持（LTS）版本](https://www.jenkins.io/download)，该版本已准备就绪。但是，此映像不包含 Docker CLI，并且未与常用的 Blue Ocean 插件及其功能捆绑在一起。要使用 Jenkins 和 Docker 的全部功能，可能需要完成下面描述的安装过程。

> 每次发布 Jenkins Docker 的新版本时，都会发布一个新的 `jenkins/jenkins` 镜像。可以在 [tags](https://hub.docker.com/r/jenkins/jenkins/tags/) 页面上看到以前发布的 `jenkins/jenkins` 镜像版本的列表。

#### macOS 和 Linux

1. 打开终端窗口。

2. 使用以下 [`docker network create`](https://docs.docker.com/engine/reference/commandline/network_create/) 命令在 Docker 中创建[桥接网络](https://docs.docker.com/network/bridge/)：

   ```bash
   docker network create jenkins
   ```

3. 要在 Jenkins 节点内执行 Docker 命令，请使用以下 [`docker run`](https://docs.docker.com/engine/reference/run/) 命令下载并运行 `docker：dind` Docker 镜像：

   ```bash
   docker run \
     --name jenkins-docker \
     --rm \
     --detach \
     --privileged \
     --network jenkins \
     --network-alias docker \
     --env DOCKER_TLS_CERTDIR=/certs \
     --volume jenkins-docker-certs:/certs/client \
     --volume jenkins-data:/var/jenkins_home \
     --publish 2376:2376 \
     docker:dind \
     --storage-driver overlay2
   ```

   * （ *可选* ）指定用于运行映像的 Docker 容器名称。默认情况下，Docker 会为容器生成唯一名称。
   * （ *可选* ）关闭 Docker 容器（Docker 镜像的副本）时自动删除该容器。
   * （ *可选* ）在后台运行 Docker 容器。可以通过运行 `docker stop jenkins-docker` 来停止此过程。
   * Running Docker in Docker currently requires privileged access to function properly. This requirement may be relaxed with newer Linux kernel versions. 目前在 Docker 中运行 Docker 需要特权访问权限才能正常运行。对于较新的 Linux 内核版本，此要求可能会放宽。
   * 这与在前面的步骤中创建的网络相对应。
   * Makes the Docker in Docker container available as the hostname `docker` within the `jenkins` network. 使 Docker 容器中的 Docker 可用作 `jenkins` 网络中的主机名 `docker`。
   * Enables the use of TLS in the Docker server. Due to the use of a privileged container, this is recommended, though it requires the use of the shared volume described below. This environment variable controls the root directory where Docker TLS certificates are managed. 允许在 Docker 服务器中使用 TLS。由于使用特权容器，因此建议这样做，尽管它需要使用下面描述的共享卷。此环境变量控制管理 Docker TLS 证书的根目录。
   * Maps the `/certs/client` directory inside the container to a Docker volume named `jenkins-docker-certs` as created above. 将容器内的 `/certs/client` 目录映射到上面创建的名为 `jenkins-docker-certs` 的 Docker 卷。
   * Maps the `/var/jenkins_home` directory inside the container to the Docker volume named `jenkins-data`. This allows for other Docker containers controlled by this Docker container’s Docker daemon to mount data from Jenkins. 将容器内的 `/var/jenkins_home` 目录映射到名为 `jenkins-data` 的 Docker 卷。这允许由此 Docker 容器的 Docker 守护程序控制的其他 Docker 容器从 Jenkins 挂载数据。
   * ( *Optional* ) Exposes the Docker daemon port on the host machine. This is useful for executing `docker` commands on the host machine to control this inner Docker daemon. （ *可选* ）公开主机上的 Docker 守护程序端口。这对于在主机上执行 `docker` 命令以控制此内部 Docker 守护程序非常有用。
   * The `docker:dind` image itself. Download this image before running, by using the command: `docker image pull docker:dind`. `docker：dind` 镜像本身。在运行之前，使用以下命令下载此映像：`docker image pull docker：dind`。
   * The storage driver for the Docker volume. Refer to the [Docker storage drivers](https://docs.docker.com/storage/storagedriver/select-storage-driver) documentation for supported options. Docker 卷的存储驱动程序。有关支持的选项，请参阅 [Docker 存储驱动程序](https://docs.docker.com/storage/storagedriver/select-storage-driver)文档。

4. 通过执行以下两个步骤自定义官方 Jenkins Docker 镜像：

   * 创建包含以下内容的 Dockerfile：

     ```dockerfile
     FROM jenkins/jenkins:2.516.3-jdk21
     USER root
     RUN apt-get update && apt-get install -y lsb-release ca-certificates curl && \
         install -m 0755 -d /etc/apt/keyrings && \
         curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc && \
         chmod a+r /etc/apt/keyrings/docker.asc && \
         echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] \
         https://download.docker.com/linux/debian $(. /etc/os-release && echo \"$VERSION_CODENAME\") stable" \
         | tee /etc/apt/sources.list.d/docker.list > /dev/null && \
         apt-get update && apt-get install -y docker-ce-cli && \
         apt-get clean && rm -rf /var/lib/apt/lists/*
     USER jenkins
     RUN jenkins-plugin-cli --plugins "blueocean docker-workflow json-path-api"
     ```

   * 从此 Dockerfile 构建一个新的 Docker 镜像，并为该镜像分配一个有意义的名称，例如 “`myjenkins-blueocean:2.516.3-1`”：

     ```bash
     docker build -t myjenkins-blueocean:2.516.3-1 .
     ```

     如果尚未下载官方 Jenkins Docker 镜像，上述过程会自动为您下载。

5. 使用以下 [`docker run`](https://docs.docker.com/engine/reference/run/) 命令在 Docker 中将自己的 `myjenkins-blueocean:2.516.3-1` 镜像作为容器运行：

   ```dockerfile
   docker run \
     --name jenkins-blueocean \
     --restart=on-failure \
     --detach \
     --network jenkins \
     --env DOCKER_HOST=tcp://docker:2376 \
     --env DOCKER_CERT_PATH=/certs/client \
     --env DOCKER_TLS_VERIFY=1 \
     --publish 8080:8080 \
     --publish 50000:50000 \
     --volume jenkins-data:/var/jenkins_home \
     --volume jenkins-docker-certs:/certs/client:ro \
    myjenkins-blueocean:2.516.3-1
   ```

   * ( *可选* ）指定此 Docker 映像实例的 Docker 容器名称。
   * 如果容器停止，请始终重新启动容器。如果手动停止，则仅在 Docker 守护程序重新启动或手动重新启动容器本身时重新启动。
   * 

6. 

   ```
   
   ```









|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      |                                                              |
|      | ( *Optional* ) Runs the current container in the background, known as "detached" mode, and outputs the container ID. If you do not specify this option, then the running Docker log for this container is displayed in the terminal window. （ *可选* ）在后台运行当前容器（称为“分离”模式），并输出容器 ID。如果未指定此选项，则此容器的正在运行的 Docker 日志将显示在终端窗口中。 |
|      | Connects this container to the `jenkins` network previously defined. The Docker daemon is now available to this Jenkins container through the hostname `docker`. 将此容器连接到先前定义的 `jenkins` 网络。Docker 守护程序现在可通过主机名 `docker` 提供给此 Jenkins 容器。 |
|      | Specifies the environment variables used by `docker`, `docker-compose`, and other Docker tools to connect to the Docker daemon from the previous step. 指定 `docker`、`docker-compose` 和其他 Docker 工具用于连接到上一步中的 Docker 守护程序的环境变量。 |
|      | Maps, or publishes, port 8080 of the current container to port 8080 on the host machine. The first number represents the port on the host, while the last represents the container’s port. For example, to access Jenkins on your host machine through port 49000, enter `-p 49000:8080` for this option. 将当前容器的端口 8080 映射或发布到主机上的端口 8080。第一个数字表示主机上的端口，而最后一个数字表示容器的端口。例如，要通过端口 49000 访问主机上的 Jenkins，请为此选项输入 `-p 49000：8080`。 |
|      | ( *Optional* ) Maps port 50000 of the current container to port 50000 on the host  machine. This is only necessary if you have set up one or more inbound Jenkins  agents on other machines, which in turn interact with your `jenkins-blueocean` container, known as the Jenkins "controller". Inbound Jenkins agents communicate with the Jenkins controller through TCP port 50000 by default. You can change this port number on your Jenkins controller through the [Security](https://www.jenkins.io/doc/book/managing/security/) page. For example, if you update the **TCP port for inbound Jenkins agents** of your Jenkins controller to 51000, you need to re-run Jenkins via the `docker run …` command. Specify the "publish" option as follows: the first value is the port  number on the machine hosting the Jenkins controller, and the last value matches the changed value on the Jenkins controller, for example,`--publish 52000:51000`. Inbound Jenkins agents communicate with the Jenkins controller on that port (52000 in this example). Note that [WebSocket agents](https://www.jenkins.io/blog/2020/02/02/web-socket/) do not need this configuration. （ *可选* ）将当前容器的端口 50000 映射到主机上的端口 50000。仅当您在其他计算机上设置了一个或多个入站 Jenkins 代理时，才需要这样做，这些代理又与您的 `jenkins-blueocean` 容器（称为 Jenkins“控制器”）交互。默认情况下，入站 Jenkins 代理通过 TCP 端口 50000 与 Jenkins 控制器通信。您可以通过 [Security （安全](https://www.jenkins.io/doc/book/managing/security/)） 页面更改 Jenkins 控制器上的此端口号。例如，如果将 Jenkins 控制器的**入站 Jenkins 代理的 TCP 端口**更新为 51000，则需要通过 `docker run ...` 命令重新运行 Jenkins。指定“发布”选项，如下所示：第一个值是托管 Jenkins 控制器的计算机上的端口号，最后一个值与 Jenkins 控制器上的更改值匹配，例如，`--publish 52000：51000`。入站 Jenkins 代理与该端口上的 Jenkins 控制器通信（本例中为 52000）。请注意，[WebSocket 代理](https://www.jenkins.io/blog/2020/02/02/web-socket/)不需要此配置。 |
|      | Maps the `/var/jenkins_home` directory in the container to the Docker [volume](https://docs.docker.com/engine/admin/volumes/volumes/) with the name `jenkins-data`. Instead of mapping the `/var/jenkins_home` directory to a Docker volume, you can also map this directory to one on your machine’s local file system. For example, specify the option `--volume $HOME/jenkins:/var/jenkins_home` to map the container’s `/var/jenkins_home` directory to the `jenkins` subdirectory within the `$HOME` directory on your local machine — typically `/Users/<your-username>/jenkins` or `/home/<your-username>/jenkins`. NOTE: If you change the source volume or directory for this, the volume from the `docker:dind` container above needs to be updated to match this. 将容器中的 `/var/jenkins_home` 目录映射到名为 `jenkins-data` 的 Docker [卷](https://docs.docker.com/engine/admin/volumes/volumes/)。您还可以将此目录映射到计算机本地文件系统上的目录，而不是将 `/var/jenkins_home` 目录映射到 Docker 卷。例如，指定选项 `--volume $HOME/jenkins:/var/jenkins_home` 以将容器的 `/var/jenkins_home` 目录映射到本地计算机上 `$HOME` 目录中的 `jenkins` 子目录 — 通常 `/Users/<your-username>/jenkins` 为 `/home/<your-username>/jenkins`。注意：如果您更改了此卷或目录，则需要更新上述 `docker：dind` 容器中的卷以匹配此内容。 |
|      | Maps the `/certs/client` directory to the previously created `jenkins-docker-certs` volume. The client TLS certificates required to connect to the Docker daemon are now available in the path specified by the `DOCKER_CERT_PATH` environment variable. 将 `/certs/client` 目录映射到之前创建的 `jenkins-docker-certs` 卷。连接到 Docker 守护程序所需的客户端 TLS 证书现在在 `DOCKER_CERT_PATH` 环境变量指定的路径中可用。 |
|      | The name of the Docker image, which you built in the previous step. 您在上一步中构建的 Docker 镜像的名称。 |

|      | If you have problems copying and pasting the command snippet, use the annotation-free version below:  如果您在复制和粘贴命令代码段时遇到问题，请使用下面的无注释版本： |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

```
docker run --name jenkins-blueocean --restart=on-failure --detach \
  --network jenkins --env DOCKER_HOST=tcp://docker:2376 \
  --env DOCKER_CERT_PATH=/certs/client --env DOCKER_TLS_VERIFY=1 \
  --publish 8080:8080 --publish 50000:50000 \
  --volume jenkins-data:/var/jenkins_home \
  --volume jenkins-docker-certs:/certs/client:ro \
  myjenkins-blueocean:2.462.3-1
```

1. Proceed to the [Post-installation setup wizard](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard).
   继续执行[安装后设置向导](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard)。

#### Windows

The Jenkins project provides a Linux container image, not a Windows container image. Be sure that your Docker for Windows installation is configured to run `Linux Containers` rather than `Windows Containers`. Refer to the Docker documentation for instructions to [switch to Linux containers](https://docs.docker.com/docker-for-windows/#switch-between-windows-and-linux-containers). Once configured to run `Linux Containers`, the steps are:
Jenkins 项目提供的是 Linux 容器映像，而不是 Windows 容器映像。确保您的 Docker for Windows 安装配置为运行 `Linux 容器`而不是 `Windows 容器`。请参阅 Docker 文档，了解[切换到 Linux 容器](https://docs.docker.com/docker-for-windows/#switch-between-windows-and-linux-containers)的说明。配置为运行 `Linux 容器`后，步骤如下：

1. Open up a command prompt window and similar to the [macOS and Linux](https://www.jenkins.io/doc/book/installing/docker/#on-macos-and-linux) instructions above do the following:
   打开命令提示符窗口，然后与上面的 [macOS 和 Linux](https://www.jenkins.io/doc/book/installing/docker/#on-macos-and-linux) 说明类似，执行以下操作：

2. Create a bridge network in Docker
   在 Docker 中创建桥接网络

   ```
   docker network create jenkins
   ```

Run a docker:dind Docker image
运行 docker：dind Docker 镜像

```
docker run --name jenkins-docker --rm --detach ^
  --privileged --network jenkins --network-alias docker ^
  --env DOCKER_TLS_CERTDIR=/certs ^
  --volume jenkins-docker-certs:/certs/client ^
  --volume jenkins-data:/var/jenkins_home ^
  --publish 2376:2376 ^
  docker:dind
```

Customize the official Jenkins Docker image, by executing the following two steps:
通过执行以下两个步骤自定义官方 Jenkins Docker 镜像：

1. Create a Dockerfile with the following content:
   创建包含以下内容的 Dockerfile：

   ```
   FROM jenkins/jenkins:2.462.3-jdk17
   USER root
   RUN apt-get update && apt-get install -y lsb-release
   RUN curl -fsSLo /usr/share/keyrings/docker-archive-keyring.asc \
     https://download.docker.com/linux/debian/gpg
   RUN echo "deb [arch=$(dpkg --print-architecture) \
     signed-by=/usr/share/keyrings/docker-archive-keyring.asc] \
     https://download.docker.com/linux/debian \
     $(lsb_release -cs) stable" > /etc/apt/sources.list.d/docker.list
   RUN apt-get update && apt-get install -y docker-ce-cli
   USER jenkins
   RUN jenkins-plugin-cli --plugins "blueocean docker-workflow"
   ```

Build a new docker image from this Dockerfile and assign the image a meaningful name, e.g. "myjenkins-blueocean:2.462.3-1":
从此 Dockerfile 构建一个新的 Docker 镜像，并为该镜像分配一个有意义的名称，例如“myjenkins-blueocean：2.462.3-1”：

```
docker build -t myjenkins-blueocean:2.462.3-1 .
```

1. If you have not yet downloaded the official Jenkins Docker image, the above process automatically downloads it for you.
   如果您尚未下载官方 Jenkins Docker 镜像，上述过程会自动为您下载。

Run your own `myjenkins-blueocean:2.462.3-1` image as a container in Docker using the following [`docker run`](https://docs.docker.com/engine/reference/run/) command:
使用以下 [`docker run`](https://docs.docker.com/engine/reference/run/) 命令在 Docker 中将您自己的 `myjenkins-blueocean：2.462.3-1` 镜像作为容器运行：

```
docker run --name jenkins-blueocean --restart=on-failure --detach ^
  --network jenkins --env DOCKER_HOST=tcp://docker:2376 ^
  --env DOCKER_CERT_PATH=/certs/client --env DOCKER_TLS_VERIFY=1 ^
  --volume jenkins-data:/var/jenkins_home ^
  --volume jenkins-docker-certs:/certs/client:ro ^
  --publish 8080:8080 --publish 50000:50000 myjenkins-blueocean:2.462.3-1
```

1. Proceed to the [Setup wizard](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard).
   继续执行 [Setup 向导](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard)。

### 访问 Docker 容器

If you want to access your Docker container through a terminal/command prompt using the [`docker exec`](https://docs.docker.com/engine/reference/commandline/exec/) command, add an option like `--name jenkins-tutorial` to the `docker exec` command. That will access the Jenkins Docker container named "jenkins-tutorial".
如果要使用 [`docker exec`](https://docs.docker.com/engine/reference/commandline/exec/) 命令通过终端/命令提示符访问 Docker 容器，请在 `docker exec` 命令中添加类似于 `--name jenkins-tutorial` 的选项。这将访问名为 “jenkins-tutorial” 的 Jenkins Docker 容器。

You can access your docker container (through a separate terminal/command prompt window) with a `docker exec` command such as:
您可以使用 `docker exec` 命令访问您的 docker 容器（通过单独的终端/命令提示符窗口），例如：

```
docker exec -it jenkins-blueocean bash
```

### 访问 Docker 日志

You may want to access the Jenkins console log, for instance, when [Unlocking Jenkins](https://www.jenkins.io/doc/book/installing/docker/#unlocking-jenkins) as part of the [Post-installation setup wizard](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard).
您可能希望访问 Jenkins 控制台日志，例如，在[安装后安装向导](https://www.jenkins.io/doc/book/installing/docker/#setup-wizard)中解锁 [Jenkins](https://www.jenkins.io/doc/book/installing/docker/#unlocking-jenkins) 时。

Access the Jenkins console log through the terminal/command prompt window from which you executed the `docker run …` command. Alternatively, you can also access the Jenkins console log through the [Docker logs](https://docs.docker.com/engine/reference/commandline/logs/) of your container using the following command:
通过执行 `docker run ...` 命令的终端/命令提示符窗口访问 Jenkins 控制台日志。或者，您也可以使用以下命令通过容器的 [Docker 日志](https://docs.docker.com/engine/reference/commandline/logs/)访问 Jenkins 控制台日志：

```
docker logs <docker-container-name>
```

Your `<docker-container-name>` can be obtained using the `docker ps` command.
可以使用 `docker ps` 命令获取您的 `<docker-container-name>`。

### 访问 Jenkins 主目录

You can access the Jenkins home directory, to check the details of a Jenkins build in the `workspace` subdirectory, for example.
例如，您可以访问 Jenkins 主目录，以检查 `workspace` 子目录中 Jenkins 构建的详细信息。

If you mapped the Jenkins home directory (`/var/jenkins_home`) to one on your machine’s local file system, for example, in the `docker run …` command [above](https://www.jenkins.io/doc/book/installing/docker/#downloading-and-running-jenkins-in-docker), access the directory contents through your machine’s usual terminal/command prompt.
如果您将 Jenkins 主目录 （`/var/jenkins_home`） 映射到计算机本地文件系统上的主目录，例如，在上面[的](https://www.jenkins.io/doc/book/installing/docker/#downloading-and-running-jenkins-in-docker) `docker run ...` 命令中，请通过计算机通常的终端/命令提示符访问目录内容。

If you specified the `--volume jenkins-data:/var/jenkins_home` option in the `docker run …` command, access the contents of the Jenkins home directory through your container’s terminal/command prompt using the [`docker container exec`](https://docs.docker.com/engine/reference/commandline/container_exec/) command:
如果您在 `docker run ...` 命令中指定了该 `--volume jenkins-data:/var/jenkins_home` 选项，请使用 [`docker container exec`](https://docs.docker.com/engine/reference/commandline/container_exec/) 命令通过容器的终端/命令提示符访问 Jenkins 主目录的内容：

```
docker container exec -it <docker-container-name> bash
```

As per [the previous section](https://www.jenkins.io/doc/book/installing/docker/#accessing-the-jenkins-console-log-through-docker-logs), get your `<docker-container-name>` using the [`docker container ls`](https://docs.docker.com/engine/reference/commandline/container_ls/) command. If you specified the `--name jenkins-blueocean` option in the `docker container run …`  command above (refer to [Accessing the Jenkins/Blue Ocean Docker container](https://www.jenkins.io/doc/book/installing/docker/#accessing-the-jenkins-blue-ocean-docker-container) if needed), use the `docker container exec` command:
根据[上一节，](https://www.jenkins.io/doc/book/installing/docker/#accessing-the-jenkins-console-log-through-docker-logs)使用 [`docker container ls`](https://docs.docker.com/engine/reference/commandline/container_ls/) 命令获取您的 `<docker-container-name>`。如果您在上面的 `docker 容器 run ...` 命令中指定了 `--name jenkins-blueocean` 选项（如果需要，请参阅[访问 Jenkins/Blue Ocean Docker 容器](https://www.jenkins.io/doc/book/installing/docker/#accessing-the-jenkins-blue-ocean-docker-container)），请使用 `docker container exec` 命令：

```
docker container exec -it jenkins-blueocean bash
```

### Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

#### 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

#### 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/docker/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/docker/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

#### 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/docker/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/docker/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

## Kubernetes

Kubernetes 集群向 Jenkins 添加了一个新的自动化层。Kubernetes 确保资源得到有效利用，并且您的服务器和底层基础设施不会过载。Kubernetes 编排容器部署的能力可确保 Jenkins 始终拥有适量的可用资源。

Hosting Jenkins on a Kubernetes Cluster is beneficial for Kubernetes-based  deployments and dynamic container-based scalable Jenkins agents. Here, we see a step-by-step process for setting up Jenkins on a  Kubernetes Cluster.
在 Kubernetes 集群上托管 Jenkins 有利于基于 Kubernetes 的部署和基于容器的动态可扩展 Jenkins 代理。在这里，我们看到了在 Kubernetes 集群上设置 Jenkins 的分步过程。

### 在 Kubernetes 上设置 Jenkins

要在 Kubernetes 上设置 Jenkins 集群，将执行以下操作：

1. [创建 Namespace](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-namespace)
2. [Create a service account](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-service-account) with Kubernetes admin permissions.
   创建具有 Kubernetes 管理员权限[的服务帐户](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-service-account)。
3. [Create local persistent volume](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-volume) for persistent Jenkins data on Pod restarts.
   在 Pod 重启时为持久 Jenkins 数据[创建本地持久卷](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-volume)。
4. [Create a deployment YAML](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-deployment) and deploy it.
   [创建部署 YAML](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-deployment) 并部署它。
5. [Create a service YAML](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-service) and deploy it.
   [创建服务 YAML](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-service) 并部署它。

|      | This guide doesn’t use local persistent volume as this is a generic  guide. For using persistent volume for your Jenkins data, you need to create  volumes of relevant cloud or on-prem data center and configure it.  本指南不使用本地持久卷，因为这是一个通用指南。要对 Jenkins 数据使用持久性卷，您需要创建相关云或本地数据中心的卷并对其进行配置。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### Jenkins Kubernetes Manifest Files Jenkins Kubernetes 清单文件

All the Jenkins Kubernetes manifest files used here are hosted on GitHub. Please clone the repository if you have trouble copying the manifest from the document.
此处使用的所有 Jenkins Kubernetes 清单文件都托管在 GitHub 上。如果您在从文档中复制清单时遇到问题，请克隆存储库。

```
git clone https://github.com/scriptcamp/kubernetes-jenkins
```

Use the GitHub files for reference and follow the steps in the next sections.
使用 GitHub 文件作为参考，并按照下一节中的步骤操作。

### Kubernetes Jenkins 部署

Let’s get started with deploying Jenkins on Kubernetes.
让我们开始在 Kubernetes 上部署 Jenkins。

**Step 1**: Create a Namespace for Jenkins. It is good to categorize all the DevOps tools as a separate namespace from other applications.
**第 1 步**：为 Jenkins 创建 Namespace。最好将所有 DevOps 工具分类为独立于其他应用程序的命名空间。

```
kubectl create namespace devops-tools
```

**Step 2:** Create a 'serviceAccount.yaml' file and copy the following admin service account manifest.
**步骤2：**创建“serviceAccount.yaml”文件并复制以下管理员服务帐户清单。

```
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: jenkins-admin
rules:
  - apiGroups: [""]
    resources: ["*"]
    verbs: ["*"]
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: jenkins-admin
  namespace: devops-tools
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: jenkins-admin
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: jenkins-admin
subjects:
- kind: ServiceAccount
  name: jenkins-admin
  namespace: devops-tools
```

The 'serviceAccount.yaml' creates a 'jenkins-admin' clusterRole,  'jenkins-admin' ServiceAccount and binds the 'clusterRole' to the  service account.
'serviceAccount.yaml' 创建一个 'jenkins-admin' clusterRole、'jenkins-admin' ServiceAccount，并将 'clusterRole' 绑定到服务账户。

The 'jenkins-admin' cluster role has all the permissions to manage the cluster components. You can also restrict access by specifying individual resource actions.
'jenkins-admin' 集群角色具有管理集群组件的所有权限。您还可以通过指定单个资源操作来限制访问。

Now create the service account using kubectl.
现在使用 kubectl 创建服务帐户。

```
kubectl apply -f serviceAccount.yaml
```

**Step 3:** Create 'volume.yaml' and copy the following persistent volume manifest.
**步骤3：** 创建 'volume.yaml' 并复制以下持久卷清单。

```
kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: local-storage
provisioner: kubernetes.io/no-provisioner
volumeBindingMode: WaitForFirstConsumer
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: jenkins-pv-volume
  labels:
    type: local
spec:
  storageClassName: local-storage
  claimRef:
    name: jenkins-pv-claim
    namespace: devops-tools
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  local:
    path: /mnt
  nodeAffinity:
    required:
      nodeSelectorTerms:
      - matchExpressions:
        - key: kubernetes.io/hostname
          operator: In
          values:
          - worker-node01
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: jenkins-pv-claim
  namespace: devops-tools
spec:
  storageClassName: local-storage
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 3Gi
```

**Important Note:** Replace 'worker-node01' with any one of your cluster worker nodes hostname.
**重要提示：**将 'worker-node01' 替换为您的任何一个集群 Worker 节点主机名。

You can get the worker node hostname using the kubectl.
您可以使用 kubectl 获取 worker 节点主机名。

```
kubectl get nodes
```

For volume, we are using the 'local' storage class for the purpose of demonstration. Meaning, it creates a 'PersistentVolume' volume in a specific node under the '/mnt' location.
对于卷，我们使用 'local' 存储类进行演示。这意味着，它会在 '/mnt' 位置下的特定节点中创建一个 'PersistentVolume' 卷。

As the 'local' storage class requires the node selector, you need to  specify the worker node name correctly for the Jenkins pod to get  scheduled in the specific node.
由于 “local” 存储类需要节点选择器，因此您需要正确指定 Jenkins Pod 的工作节点名称，以便在特定节点中调度。

If the pod gets deleted or restarted, the data will get persisted in the node volume. However, if the node gets deleted, you will lose all the data.
如果 Pod 被删除或重新启动，数据将持久化在节点卷中。但是，如果节点被删除，您将丢失所有数据。

Ideally, you should use a persistent volume using the available storage class  with the cloud provider, or the one provided by the cluster  administrator to persist data on node failures.
理想情况下，您应该使用使用云提供商提供的可用存储类的持久卷，或者使用集群管理员提供的持久卷，以便在节点发生故障时保留数据。

Let’s create the volume using kubectl
让我们使用 kubectl 创建卷

```
kubectl create -f volume.yaml
```

**Step 4:** Create a Deployment file named 'deployment.yaml' and copy the following deployment manifest.
**步骤4：**创建名为 'deployment.yaml' 的 Deployment 文件并复制以下部署清单。

```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: jenkins
  namespace: devops-tools
spec:
  replicas: 1
  selector:
    matchLabels:
      app: jenkins-server
  template:
    metadata:
      labels:
        app: jenkins-server
    spec:
      securityContext:
            fsGroup: 1000
            runAsUser: 1000
      serviceAccountName: jenkins-admin
      containers:
        - name: jenkins
          image: jenkins/jenkins:lts
          resources:
            limits:
              memory: "2Gi"
              cpu: "1000m"
            requests:
              memory: "500Mi"
              cpu: "500m"
          ports:
            - name: httpport
              containerPort: 8080
            - name: jnlpport
              containerPort: 50000
          livenessProbe:
            httpGet:
              path: "/login"
              port: 8080
            initialDelaySeconds: 90
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 5
          readinessProbe:
            httpGet:
              path: "/login"
              port: 8080
            initialDelaySeconds: 60
            periodSeconds: 10
            timeoutSeconds: 5
            failureThreshold: 3
          volumeMounts:
            - name: jenkins-data
              mountPath: /var/jenkins_home
      volumes:
        - name: jenkins-data
          persistentVolumeClaim:
              claimName: jenkins-pv-claim
```

In this Jenkins Kubernetes deployment we have used the following:
在这个 Jenkins Kubernetes 部署中，我们使用了以下内容：

1. 'securityContext' for Jenkins pod to be able to write to the local persistent volume.
   'securityContext' 以便 Jenkins Pod 能够写入本地持久卷。
2. Liveness and readiness probe to monitor the health of the Jenkins pod.
   运行情况和就绪情况探测，用于监控 Jenkins Pod 的运行状况。
3. Local persistent volume based on local storage class that holds the Jenkins data path '/var/jenkins_home'.
   基于保存 Jenkins 数据路径 '/var/jenkins_home' 的本地存储类的本地持久卷。

|      | The deployment file uses local storage class persistent volume for Jenkins data. For production use cases, you should add a cloud-specific storage class persistent volume for your Jenkins data.  部署文件对 Jenkins 数据使用本地存储类持久卷。对于生产使用案例，您应该为 Jenkins 数据添加特定于云的存储类持久卷。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

If you don’t want the local storage persistent volume, you can replace the volume definition in the deployment with the host directory as shown  below.
如果您不需要本地存储持久卷，则可以将部署中的卷定义替换为主机目录，如下所示。

```
volumes:
- name: jenkins-data
  emptyDir: \{}
```

Create the deployment using kubectl.
使用 kubectl 创建部署。

```
kubectl apply -f deployment.yaml
```

Check the deployment status.
检查部署状态。

```
kubectl get deployments -n devops-tools
```

Now, you can get the deployment details using the following command.
现在，您可以使用以下命令获取部署详细信息。

```
kubectl describe deployments --namespace=devops-tools
```

### 使用 Kubernetes Service 访问 Jenkins

We have now created a deployment. However, it is not accessible to the outside world. For accessing the Jenkins deployment from the outside world, we need to create a service and map it to the deployment.
现在，我们已经创建了一个部署。但是，它不向外界开放。要从外部访问 Jenkins 部署，我们需要创建一个服务并将其映射到部署。

Create 'service.yaml' and copy the following service manifest:
创建 'service.yaml' 并复制以下服务清单：

```
apiVersion: v1
kind: Service
metadata:
  name: jenkins-service
  namespace: devops-tools
  annotations:
      prometheus.io/scrape: 'true'
      prometheus.io/path:   /
      prometheus.io/port:   '8080'
spec:
  selector:
    app: jenkins-server
  type: NodePort
  ports:
    - port: 8080
      targetPort: 8080
      nodePort: 32000
```

|      | Here, we are using the type as 'NodePort' which will expose Jenkins on all kubernetes node IPs on port 32000. If you have an ingress setup, you can create an ingress rule to access Jenkins. Also, you can expose the Jenkins service as a Loadbalancer if you are running the cluster on AWS, Google, or Azure cloud.  在这里，我们使用 'NodePort' 类型，它将在端口 32000 上的所有 kubernetes 节点 IP 上公开  Jenkins。如果您有入口设置，则可以创建入口规则来访问 Jenkins。此外，如果您在 AWS、Google 或 Azure  云上运行集群，则可以将 Jenkins 服务作为负载均衡器公开。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

Create the Jenkins service using kubectl.
使用 kubectl 创建 Jenkins 服务。

```
kubectl apply -f service.yaml
```

Now, when browsing to any one of the Node IPs on port 32000, you will be able to access the Jenkins dashboard.
现在，当浏览到端口 32000 上的任何一个节点 IP 时，您将能够访问 Jenkins 仪表板。

```
http://<node-ip>:32000
```

Jenkins will ask for the initial Admin password when you access the dashboard for the first time.
当您首次访问控制面板时，Jenkins 将要求提供初始管理员密码。

You can get that from the pod logs either from the Kubernetes dashboard or CLI. You can get the pod details using the following CLI command.
您可以从 Kubernetes 控制面板或 CLI 从 Pod 日志中获取该信息。您可以使用以下 CLI 命令获取 Pod 详细信息。

```
kubectl get pods --namespace=devops-tools
```

With the pod name, you can get the logs as shown below. Replace the pod name with your pod name.
使用 Pod 名称，您可以获取日志，如下所示。将 Pod 名称替换为您的 Pod 名称。

```
kubectl logs jenkins-deployment-2539456353-j00w5 --namespace=devops-tools
```

The password can be found at the end of the log.
密码可以在日志的末尾找到。

Alternatively, you can run the exec command to get the password directly from the location as shown below.
或者，您可以运行 exec 命令直接从该位置获取密码，如下所示。

```
kubectl exec -it jenkins-559d8cd85c-cfcgk cat /var/jenkins_home/secrets/initialAdminPassword -n devops-tools
```

Once you enter the password, proceed to install the suggested plugin and create an admin user. All of these steps are self-explanatory from the Jenkins dashboard.
输入密码后，继续安装建议的插件并创建管理员用户。所有这些步骤在 Jenkins 仪表板中都是不言自明的。

### 使用 Helm v3 安装 Jenkins

A typical Jenkins deployment consists of a controller node and,  optionally, one or more agents. To simplify the deployment of Jenkins,  we’ll use [Helm](https://helm.sh/) to deploy Jenkins. Helm is a package manager for Kubernetes and its package format is called a chart. Many community-developed charts are available on [GitHub](https://github.com/helm/charts).
典型的 Jenkins 部署由一个控制器节点和一个或多个代理（可选）组成。为了简化 Jenkins 的部署，我们将使用 [Helm](https://helm.sh/) 来部署 Jenkins。Helm 是 Kubernetes 的包管理器，其包格式称为 chart。[GitHub](https://github.com/helm/charts) 上提供了许多社区开发的图表。

Helm Charts provide “push button” deployment and deletion of apps, making  adoption and development of Kubernetes apps easier for those with little container or microservices experience.
Helm Charts 提供应用程序的“按钮”部署和删除，使容器或微服务经验很少的用户更容易采用和开发 Kubernetes 应用程序。

### Prerequisites 先决条件

- Helm command line interface Helm 命令行界面

  If you don’t have Helm command line interface installed and configured locally, see the sections below to [Install Helm](https://www.jenkins.io/doc/book/installing/kubernetes/#install-helm) and [Configure Helm](https://www.jenkins.io/doc/book/installing/kubernetes/#configure-helm). 如果您尚未在本地安装和配置 Helm 命令行界面，请参阅以下部分以[安装 Helm](https://www.jenkins.io/doc/book/installing/kubernetes/#install-helm) 和[配置 Helm](https://www.jenkins.io/doc/book/installing/kubernetes/#configure-helm)。

### 安装 Helm

To install Helm CLI, follow the instructions from the [Installing Helm](https://helm.sh/docs/intro/install/) page.
要安装 Helm CLI，请按照[安装 Helm](https://helm.sh/docs/intro/install/) 页面中的说明进行操作。

### 配置 Helm

Once Helm is installed and set up properly, add the Jenkins repo as follows:
安装并正确设置 Helm 后，按如下方式添加 Jenkins 存储库：

```
helm repo add jenkinsci https://charts.jenkins.io
helm repo update
```

The helm charts in the Jenkins repo can be listed with the command:
Jenkins 存储库中的 helm 图表可以使用以下命令列出：

```
helm search repo jenkinsci
```

### 创建持久卷

We want to create a [persistent volume](https://kubernetes.io/docs/concepts/storage/persistent-volumes/) for our Jenkins controller pod. This will prevent us from losing our whole configuration of the Jenkins controller and our jobs when we reboot our minikube. This [official minikube doc](https://minikube.sigs.k8s.io/docs/handbook/persistent_volumes/) explains which directories we can use to mount or data. In a multi-node Kubernetes cluster, you’ll need some solution like NFS  to make the mount directory available in the whole cluster. But because we use minikube which is a one-node cluster we don’t have to bother about it.
我们想为 Jenkins 控制器 Pod 创建一个[持久卷](https://kubernetes.io/docs/concepts/storage/persistent-volumes/)。这将防止我们在重启 minikube 时丢失 Jenkins 控制器的整个配置和作业。这个[官方的 minikube 文档](https://minikube.sigs.k8s.io/docs/handbook/persistent_volumes/)解释了我们可以使用哪些目录来挂载或数据。在多节点 Kubernetes 集群中，您需要一些解决方案（如 NFS）来使挂载目录在整个集群中可用。但是因为我们使用的是 minikube，它是一个单节点集群，所以我们不必为此烦恼。

We choose to use the `/data` directory. This directory will contain our Jenkins controller configuration.
我们选择使用 `/data` 目录。此目录将包含我们的 Jenkins 控制器配置。

**We will create a volume which is called jenkins-pv:
我们将创建一个名为 jenkins-pv 的卷：**

1. Paste the content from [https://raw.githubusercontent.com/installing-jenkins-on-kubernetes/jenkins-volume.yaml](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-volume.yaml) into a YAML formatted file called `jenkins-volume.yaml`.
   将 [https://raw.githubusercontent.com/installing-jenkins-on-kubernetes/jenkins-volume.yaml](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-volume.yaml) 中的内容粘贴到名为 `jenkins-volume.yaml` 的 YAML 格式文件中。

2. Run the following command to apply the spec:
   运行以下命令以应用规范：

   ```
   kubectl apply -f jenkins-volume.yaml
   ```

|      | It’s worth noting that, in the above spec, hostPath uses the  /data/jenkins-volume/ of your node to emulate network-attached storage. This approach is only suited for development and testing purposes. For production, you should provide a network resource like a Google  Compute Engine persistent disk, or an Amazon Elastic Block Store volume.  值得注意的是，在上述规范中，hostPath 使用节点的 /data/jenkins-volume/  来模拟网络连接存储。此方法仅适用于开发和测试目的。对于生产环境，您应该提供网络资源，例如 Google Compute Engine 持久磁盘或 Amazon Elastic Block Store 卷。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

|      | Minikube configured for hostPath sets the permissions on /data to the root  account only. Once the volume is created you will need to manually  change the permissions to allow the jenkins account to write its data. 为 hostPath 配置的 Minikube 仅将 /data 的权限设置为 root 帐户。创建卷后，您需要手动更改权限以允许 jenkins 账户写入其数据。  `minikube ssh sudo chown -R 1000:1000 /data/jenkins-volume` |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### 创建服务帐户

In Kubernetes, service accounts are used to provide an identity for pods. Pods that want to interact with the API server will authenticate with a particular service account. By default, applications will authenticate as the `default` service account in the namespace they are running in. This means, for example, that an application running in the `test` namespace will use the default service account of the `test` namespace.
在 Kubernetes 中，服务帐户用于为 Pod 提供身份。想要与 API 服务器交互的 Pod 将使用特定的服务帐户进行身份验证。默认情况下，应用程序将作为运行它们的命名空间中的`默认`服务帐户进行身份验证。这意味着，例如，在 `test` 命名空间中运行的应用程序将使用 `test` 命名空间的默认服务帐户。

**We will create a service account called jenkins:
我们将创建一个名为 jenkins 的服务帐户：**

A ClusterRole is a set of permissions that can be assigned to resources  within a given cluster. Kubernetes APIs are categorized into API groups, based on the API  objects that they relate to. While creating a ClusterRole, you can specify the operations that can be performed by the ClusterRole on one or more API objects in one or more  API groups, just as we have done above. ClusterRoles have several uses. You can use a ClusterRole to:
ClusterRole 是一组可以分配给给定集群中的资源的权限。Kubernetes API 根据它们相关的 API 对象分为 API 组。在创建  ClusterRole 时，您可以指定 ClusterRole 可以对一个或多个 API 组中的一个或多个 API  对象执行的操作，就像我们上面所做的那样。ClusterRole 有多种用途。您可以使用 ClusterRole 执行以下操作：

- define permissions on namespaced resources and be granted within individual namespace(s)
  定义对命名空间资源的权限，并在单个命名空间中授予
- define permissions on namespaced resources and be granted across all namespaces
  定义对命名空间资源的权限，并在所有命名空间中被授予
- define permissions on cluster-scoped resources
  定义对集群范围资源的权限

If you want to define a role cluster-wide, use a ClusterRole; if you want to define a role within a namespace, use a Role.
如果要在集群范围内定义角色，请使用 ClusterRole;如果要在命名空间中定义角色，请使用 Role。

A role binding grants the permissions defined in a role to a user or set of users. It holds a list of subjects (users, groups, or service accounts), and a reference to the role being granted.
角色绑定将角色中定义的权限授予一个用户或一组用户。它包含主题 （用户、组或服务帐户） 的列表，以及对所授予角色的引用。

A RoleBinding may reference any Role in the same namespace. Alternatively, a RoleBinding can reference a ClusterRole and bind that ClusterRole to the namespace of the RoleBinding. To bind a ClusterRole to all the namespaces in our cluster, we use a ClusterRoleBinding.
RoleBinding 可以引用同一命名空间中的任何 Role。或者，RoleBinding 可以引用 ClusterRole 并将该 ClusterRole 绑定到 RoleBinding 的命名空间。要将 ClusterRole 绑定到集群中的所有命名空间，我们使用 ClusterRoleBinding。

1. Paste the content from [https://raw.githubusercontent.com/installing-jenkins-on-kubernetes/jenkins-sa.yaml](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-sa.yaml) into a YAML formatted file called `jenkins-sa.yaml`.
   将 [https://raw.githubusercontent.com/installing-jenkins-on-kubernetes/jenkins-sa.yaml](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-sa.yaml) 中的内容粘贴到名为 `jenkins-sa.yaml` 的 YAML 格式文件中。

2. Run the following command to apply the spec:
   运行以下命令以应用规范：

   ```
   kubectl apply -f jenkins-sa.yaml
   ```

### 安装 Jenkins

We will deploy Jenkins including the Jenkins Kubernetes plugin. See the [official chart](https://github.com/jenkinsci/helm-charts/tree/main/charts/jenkins) for more details.
我们将部署 Jenkins，包括 Jenkins Kubernetes 插件。有关更多详细信息，请参阅[官方图表](https://github.com/jenkinsci/helm-charts/tree/main/charts/jenkins)。

1. To enable persistence, we will create an override file and pass it as an argument to the Helm CLI. Paste the content from [raw.githubusercontent.com/jenkinsci/helm-charts/main/charts/jenkins/values.yaml](https://raw.githubusercontent.com/jenkinsci/helm-charts/main/charts/jenkins/values.yaml) into a YAML formatted file called `jenkins-values.yaml`.
   要启用持久性，我们将创建一个覆盖文件并将其作为参数传递给 Helm CLI。将 [raw.githubusercontent.com/jenkinsci/helm-charts/main/charts/jenkins/values.yaml](https://raw.githubusercontent.com/jenkinsci/helm-charts/main/charts/jenkins/values.yaml) 中的内容粘贴到名为 `jenkins-values.yaml` 的 YAML 格式文件中。

   The `jenkins-values.yaml` is used as a template to provide values that are necessary for setup.
   `jenkins-values.yaml` 用作模板来提供设置所需的值。

2. Open the `jenkins-values.yaml` file in your favorite text editor and modify the following:
   在您喜欢的文本编辑器中打开 `jenkins-values.yaml` 文件并修改以下内容：

   - nodePort: Because we are using minikube we need to use NodePort as service type.  Only cloud providers offer load balancers. We define port 32000 as port.
     nodePort：因为我们使用的是 minikube，所以我们需要使用 NodePort 作为服务类型。只有云提供商提供负载均衡器。我们将端口 32000 定义为端口。

   - storageClass: storageClass 的

     ```
     storageClass: jenkins-pv
     ```

serviceAccount: the serviceAccount section of the jenkins-values.yaml file should look like this:
serviceAccount：jenkins-values.yaml 文件的 serviceAccount 部分应如下所示：

```
serviceAccount:
  create: false
# Service account name is autogenerated by default
name: jenkins
annotations: {}
```

- ```
  Where `name: jenkins` refers to the serviceAccount created for jenkins.
  ```

- We can also define which plugins we want to install on our Jenkins. We use some default plugins like git and the pipeline plugin.
  我们还可以定义要在 Jenkins 上安装的插件。我们使用一些默认插件，例如 git 和 pipeline 插件。

Now you can install Jenkins by running the `helm install` command and passing it the following arguments:
现在，您可以通过运行 `helm install` 命令并向其传递以下参数来安装 Jenkins：

- The name of the release `jenkins`
  发布 `jenkins` 的名称

- The -f flag with the YAML file with overrides `jenkins-values.yaml`
  带有 YAML 文件的 -f 标志覆盖了 `jenkins-values.yaml`

- The name of the chart `jenkinsci/jenkins`
  图表 `jenkinsci/jenkins` 的名称

- The `-n` flag with the name of your namespace `jenkins`
  带有命名空间 `jenkins` 名称的 `-n` 标志

  ```
  chart=jenkinsci/jenkins
  helm install jenkins -n jenkins -f jenkins-values.yaml $chart
  ```

```
This outputs something similar to the following:
NAME: jenkins
LAST DEPLOYED: Wed Sep 16 11:13:10 2020
NAMESPACE: jenkins
STATUS: deployed
REVISION: 1
```

1. Get your 'admin' user password by running:
   通过运行以下命令获取您的 'admin' 用户密码：

   ```
   jsonpath="{.data.jenkins-admin-password}"
   secret=$(kubectl get secret -n jenkins jenkins -o jsonpath=$jsonpath)
   echo $(echo $secret | base64 --decode)
   ```

Get the Jenkins URL to visit by running these commands in the same shell:
通过在同一 shell 中运行以下命令来获取要访问的 Jenkins URL：

```
jsonpath="{.spec.ports[0].nodePort}"
NODE_PORT=$(kubectl get -n jenkins -o jsonpath=$jsonpath services jenkins)
jsonpath="{.items[0].status.addresses[0].address}"
NODE_IP=$(kubectl get nodes -n jenkins -o jsonpath=$jsonpath)
echo http://$NODE_IP:$NODE_PORT/login
```

1. Login with the password from step 1 and the username: admin
   使用步骤 1 中的密码和用户名登录：admin
2. Use Jenkins Configuration as Code by specifying configScripts in your values.yaml file. See the [configuration as code documentation](https://plugins.jenkins.io/configuration-as-code) and  [examples](https://github.com/jenkinsci/configuration-as-code-plugin/tree/master/demos).
   通过在 values.yaml 文件中指定 configScripts 来使用 Jenkins 配置作为代码。请参阅 [配置即代码 文档](https://plugins.jenkins.io/configuration-as-code)和[示例](https://github.com/jenkinsci/configuration-as-code-plugin/tree/master/demos)。

Visit the [Jenkins on Kubernetes solutions page](https://cloud.google.com/solutions/jenkins-on-container-engine) for more information on running Jenkins on Kubernetes. Visit the [Jenkins Configuration as Code project](https://www.jenkins.io/projects/jcasc/) for more information on configuration as code. . Depending on your environment, it can take a bit of time for Jenkins to start up. Enter the  following command to inspect the status of your Pod:
有关在 Kubernetes 上运行 Jenkins 的更多信息，请访问 [Kubernetes 上的 Jenkins 解决方案页面](https://cloud.google.com/solutions/jenkins-on-container-engine)。有关配置即代码的更多信息，请访问 [Jenkins 配置即代码项目](https://www.jenkins.io/projects/jcasc/)。.根据您的环境，Jenkins 可能需要一些时间才能启动。输入以下命令以检查 Pod 的状态：

```
kubectl get pods -n jenkins
```

Once Jenkins is installed, the status should be  set to Running as in the following output:
安装 Jenkins 后，状态应设置为 Running （正在运行），如以下输出所示：

```
kubectl get pods -n jenkins
NAME                       READY   STATUS    RESTARTS   AGE
jenkins-645fbf58d6-6xfvj   1/1     Running   0          2m
```

1. To access your Jenkins server, you must retrieve the password. You can retrieve your password using either of the two options below.
   要访问 Jenkins 服务器，您必须检索密码。您可以使用以下两个选项中的任何一个来检索您的密码。

   **Option 1 选项 1**

   Run the following command:
   运行以下命令：

   ```
   jsonpath="{.data.jenkins-admin-password}"
   secret=$(kubectl get secret -n jenkins jenkins -o jsonpath=$jsonpath)
   echo $(echo $secret | base64 --decode)
   ```

The output should look like this:
输出应如下所示：

```
Um1kJLOWQY
```

|      | 👆🏻Note that your password will be different. 👆🏻请注意，您的密码会有所不同。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

**Option 2 选项 2**

Run the following command:
运行以下命令：

```
jsonpath="{.data.jenkins-admin-password}"
kubectl get secret -n jenkins jenkins -o jsonpath=$jsonpath
```

The output should be a **base64 encoded string** like this:
输出应为 **base64 编码的字符串**，如下所示：

```
WkIwRkdnbDZYZg==
```

Decode the base64 string and you have your password. You can use [this website](https://www.base64decode.org/) to decode your output.
解码 base64 字符串，您就有了密码。您可以使用[此网站](https://www.base64decode.org/)来解码您的输出。

Get the name of the Pod running that is running Jenkins using the following command:
使用以下命令获取正在运行的 Jenkins 的 Pod 的名称：

```
kubectl get pods -n jenkins
```

Use the kubectl command to set up port forwarding:
使用 kubectl 命令设置端口转发：

```
kubectl -n jenkins port-forward <pod_name> 8080:8080
Forwarding from 127.0.0.1:8080 -> 8080
Forwarding from [::1]:8080 -> 8080
```

Visit [127.0.0.1:8080/](http://127.0.0.1:8080/) and log in using `admin` as the username and the password you retrieved earlier.
访问 [127.0.0.1：8080/](http://127.0.0.1:8080/) 并使用 `admin` 作为您之前检索到的用户名和密码登录。

### 使用 YAML 文件安装 Jenkins

This section describes how to use a set of YAML (Yet Another Markup Language) files to install Jenkins on a Kubernetes cluster. The YAML files are easily tracked, edited, and can be reused indefinitely.
本节介绍如何使用一组 YAML（另一种标记语言）文件在 Kubernetes 集群上安装 Jenkins。YAML 文件易于跟踪、编辑，并且可以无限期地重复使用。

### 创建 Jenkins 部署文件

Copy the contents [here](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-deployment.yaml) into your preferred text editor and create a jenkins-deployment.yaml file in the “jenkins” namespace we created in this [section](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-namespace) above.
将[此处](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-deployment.yaml)的内容复制到您的首选文本编辑器中，并在我们在上[一节](https://www.jenkins.io/doc/book/installing/kubernetes/#create-a-namespace)中创建的 “jenkins” 命名空间中创建一个 jenkins-deployment.yaml 文件。

- This [deployment file](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-deployment.yaml) is defining a Deployment as indicated by the `kind` field.
  此 [Deployment 文件](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-deployment.yaml)定义了 `kind` 字段指示的 Deployment。
- The Deployment specifies a single replica. This ensures one and only one instance will be maintained by the Replication Controller in the event of failure.
  Deployment 指定单个副本。这可确保在发生故障时，Replication Controller 将维护一个且只有一个实例。
- The container image name is jenkins and version is 2.32.2
  容器镜像名称为 jenkins，版本为 2.32.2
- The list of ports specified within the spec are a list of ports to expose from the container on the Pods IP address.
  规范中指定的端口列表是要从容器的 Pod IP 地址上公开的端口列表。
  - Jenkins running on (http) port 8080.
    Jenkins 在 （http） 端口 8080 上运行。
  - The Pod exposes the port 8080 of the jenkins container.
    Pod 暴露了 jenkins 容器的 8080 端口。
- The volumeMounts section of the file creates a Persistent Volume. This volume is mounted within the container at the path /var/jenkins_home and so modifications to data within /var/jenkins_home are written to the volume. The role of a persistent volume is to store basic Jenkins data and preserve it beyond the lifetime of a pod.
  该文件的 volumeMounts 部分将创建一个持久卷。此卷挂载在容器中的路径 /var/jenkins_home，因此对  /var/jenkins_home 中数据的修改将写入该卷。持久卷的作用是存储基本的 Jenkins 数据，并在 Pod  的生命周期之外保留这些数据。

Exit and save the changes once you add the content to the Jenkins deployment file.
将内容添加到 Jenkins 部署文件后，退出并保存更改。

### 部署 Jenkins

To create the deployment execute:
要创建部署，请执行：

```
kubectl create -f jenkins-deployment.yaml -n jenkins
```

The command also instructs the system to install Jenkins within the jenkins namespace.
该命令还指示系统在 jenkins 命名空间中安装 Jenkins。

To validate that creating the deployment was successful you can invoke:
要验证创建部署是否成功，您可以调用：

```
kubectl get deployments -n jenkins
```

### 授予对 Jenkins 服务的访问权限

We have a Jenkins controller deployed but it is still not accessible. The Jenkins Pod has been assigned an IP address that is internal to the  Kubernetes cluster. It’s possible to log into the Kubernetes Node and access Jenkins from  there but that’s not a very useful way to access the service.
我们已经部署了一个 Jenkins 控制器，但它仍然无法访问。Jenkins Pod 已被分配一个 Kubernetes 集群内部的 IP 地址。可以登录到 Kubernetes 节点并从那里访问 Jenkins，但这不是访问该服务的非常有用的方式。

To make Jenkins accessible outside the Kubernetes cluster the Pod needs to be exposed as a Service. A Service is an abstraction that exposes Jenkins to the wider network. It allows us to maintain a persistent connection to the pod regardless of the changes in the cluster. With a local deployment, this means creating a NodePort service type. A NodePort service type exposes a service on a port on each node in the cluster. The service is accessed through the Node IP address and the service nodePort. A simple service is defined [here](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-service.yaml):
要使 Jenkins 可在 Kubernetes 集群外部访问，需要将 Pod 作为 Service 公开。Service 是将 Jenkins  暴露给更广泛网络的抽象。它允许我们保持与 Pod 的持久连接，而不管集群中的更改如何。对于本地部署，这意味着创建 NodePort  服务类型。NodePort 服务类型在集群中每个节点的端口上公开服务。该服务通过 Node IP 地址和服务 nodePort 访问。[此处](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-service.yaml)定义了一个简单的服务：

- This [service file](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-service.yaml) is defining a Service as indicated by the `kind` field.
  此[服务文件](https://raw.githubusercontent.com/jenkins-infra/jenkins.io/master/content/doc/tutorials/kubernetes/installing-jenkins-on-kubernetes/jenkins-service.yaml)正在定义 `kind` 字段指示的 Service。
- The Service is of type NodePort. Other options are ClusterIP (only  accessible within the cluster) and LoadBalancer (IP address assigned by a cloud provider e.g. AWS Elastic IP).
  Service 的类型为 NodePort。其他选项包括 ClusterIP（只能在集群内访问）和 LoadBalancer（由云提供商分配的 IP 地址，例如 AWS 弹性 IP）。
- The list of ports specified within the spec is a list of ports exposed by this service.
  规范中指定的端口列表是此服务公开的端口列表。
  - The port is the port that will be exposed by the service.
    port 是服务将公开的端口。
  - The target port is the port to access the Pods targeted by this service. A port name may also be specified.
    目标端口是访问此服务所针对的 Pod 的端口。还可以指定端口名称。
- The selector specifies the selection criteria for the Pods targeted by this service.
  选择器指定此服务所针对的 Pod 的选择标准。

To create the service execute:
要创建服务，请执行：

```
kubectl create -f jenkins-service.yaml -n jenkins
```

To validate that creating the service was successful you can run:
要验证创建服务是否成功，您可以运行：

```
kubectl get services -n jenkins
NAME       TYPE        CLUSTER-IP       EXTERNAL-IP    PORT(S)           AGE
jenkins    NodePort    10.103.31.217    <none>         8080:32664/TCP    59s
```

### 访问 Jenkins 控制面板

So now we have created a deployment and service, how do we access Jenkins?
那么现在我们已经创建了一个部署和服务，我们如何访问 Jenkins？

From the output above we can see that the service has been exposed on port 32664. We also know that because the service is of type NodeType the service will route requests made to any node on this port to the Jenkins pod. All that’s left for us is to determine the IP address of the minikube VM. Minikube have made this really simple by including a specific command that outputs the IP address of the running cluster:
从上面的输出中，我们可以看到该服务已在端口 32664 上公开。我们还知道，由于该服务的类型为 NodeType，因此该服务会将对此端口上的任何节点发出的请求路由到 Jenkins  Pod。剩下的工作就是确定 minikube VM 的 IP 地址。Minikube 通过包含一个输出正在运行的集群的 IP  地址的特定命令，使这变得非常简单：

```
minikube ip
192.168.99.100
```

Now we can access the Jenkins controller at [192.168.99.100:32664/](http://192.168.99.100:32664/)
现在我们可以在 [192.168.99.100：32664/](http://192.168.99.100:32664/) 访问 Jenkins 控制器

To access Jenkins, you initially need to enter your credentials. The default username for new installations is admin. The password can be obtained in several ways. This example uses the Jenkins deployment pod name.
要访问 Jenkins，您首先需要输入您的凭证。新安装的默认用户名是 admin。可以通过多种方式获取密码。此示例使用 Jenkins 部署 Pod 名称。

To find the name of the pod, enter the following command:
要查找 Pod 的名称，请输入以下命令：

```
kubectl get pods -n jenkins
```

Once you locate the name of the pod, use it to access the pod’s logs.
找到 Pod 的名称后，使用它来访问 Pod 的日志。

```
kubectl logs <pod_name> -n jenkins
```

The password is at the end of the log formatted as a long alphanumeric string:
密码位于日志的末尾，格式为长字母数字字符串：

```
*************************************************************
*************************************************************
*************************************************************

Jenkins initial setup is required.
An admin user has been created and a password generated.
Please use the following password to proceed to installation:

94b73ef6578c4b4692a157f768b2cfef

This may also be found at:
/var/jenkins_home/secrets/initialAdminPassword

*************************************************************
*************************************************************
*************************************************************
```

You have successfully installed Jenkins on your Kubernetes cluster and can  use it to create new and efficient development pipelines.
您已在 Kubernetes 集群上成功安装了 Jenkins，并可以使用它来创建新的高效开发管道。

### 使用 Jenkins Operator 安装 Jenkins

The [Jenkins Operator](https://jenkinsci.github.io/kubernetes-operator/docs/) is a Kubernetes native Operator which manages operations for Jenkins on Kubernetes.
[Jenkins Operator](https://jenkinsci.github.io/kubernetes-operator/docs/) 是 Kubernetes 原生 Operator，用于管理 Kubernetes 上的 Jenkins 操作。

It was built with immutability and declarative configuration as code in mind, to automate many of the manual tasks required to deploy and run Jenkins on Kubernetes.
它在构建时考虑了不变性和声明性配置即代码，以自动执行在 Kubernetes 上部署和运行 Jenkins 所需的许多手动任务。

Jenkins Operator is easy to install with applying just a few yaml manifests or with the use of Helm.
Jenkins Operator 只需应用几个 yaml 清单或使用 Helm 即可轻松安装。

For instructions on installing Jenkins Operator on your Kubernetes cluster and deploying and configuring Jenkins there, see [official documentation of Jenkins Operator](https://jenkinsci.github.io/kubernetes-operator/docs/getting-started/latest/).
有关在 Kubernetes 集群上安装 Jenkins Operator 以及在 Kubernetes 集群中部署和配置 Jenkins 的说明，请参阅 [Jenkins Operator 的官方文档](https://jenkinsci.github.io/kubernetes-operator/docs/getting-started/latest/)。

### post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

#### 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

#### 插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/kubernetes/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/kubernetes/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

#### 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/kubernetes/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/kubernetes/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

### Conclusion 结论

When you host Jenkins on Kubernetes for production workloads, you need to  consider setting up a highly available persistent volume, to avoid data  loss during pod or node deletion.
当您在 Kubernetes 上托管 Jenkins 以处理生产工作负载时，您需要考虑设置高可用性持久性卷，以避免在删除 Pod 或节点期间丢失数据。

A pod or node deletion could happen anytime in Kubernetes environments. It could be a patching activity or a downscaling activity.
在 Kubernetes 环境中，Pod 或节点删除可能随时发生。它可以是修补活动或缩减活动。

Hopefully, this step-by-step guide helps you learn and understand the components  involved in setting up a Jenkins server on a Kubernetes cluster.
希望本分步指南可以帮助您学习和理解在 Kubernetes 集群上设置 Jenkins 服务器所涉及的组件。

## Linux

Jenkins 安装程序可用于多个 Linux 发行版。

- Debian/Ubuntu
- Fedora
- Red Hat/Alma/Rocky

### Debian/Ubuntu

在基于 Debian 和 Debian 的发行版（如 Ubuntu）上，可以通过 `apt` 安装 Jenkins。

> 随着 [Debian 12](https://www.debian.org/News/2023/20230610) 的发布，OpenJDK 11 **不再**包含在内。它已被 [OpenJDK 17](https://openjdk.org/projects/jdk/17/) 取代。

#### 长期支持版本

每 12 周从常规版本流中选择一个 [LTS（长期支持）版本](https://www.jenkins.io/download/lts/)作为该时间段的稳定版本。它可以从 [`debian-stable` apt 仓库](https://pkg.jenkins.io/debian-stable/)安装。

```bash
sudo wget -O /usr/share/keyrings/jenkins-keyring.asc https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key

echo "deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc]" https://pkg.jenkins.io/debian-stable binary/ | sudo tee /etc/apt/sources.list.d/jenkins.list > /dev/null

sudo apt-get update
sudo apt-get install jenkins
```

#### 每周发布

每周都会生成一个新版本，以向用户和插件开发人员提供错误修复和功能。它可以从 [`debian` apt 存储库](https://pkg.jenkins.io/debian/)安装。

```bash
sudo wget -O /usr/share/keyrings/jenkins-keyring.asc https://pkg.jenkins.io/debian/jenkins.io-2023.key

echo "deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc]" https://pkg.jenkins.io/debian binary/ | sudo tee /etc/apt/sources.list.d/jenkins.list > /dev/null

sudo apt-get update
sudo apt-get install jenkins
```

从 Jenkins 2.335 和 Jenkins 2.332.1 开始，该软件包配置了 `systemd`，而不是旧的 System V `init`。

软件包安装将：

- 将 Jenkins 设置为开机时启动的守护程序。运行 `systemctl cat jenkins` 了解更多详细信息。

- 创建一个 'jenkins' 用户来运行此服务。

- 将控制台日志输出直接发送到 `systemd-journald`。如果要对 Jenkins 进行故障排除，请运行 `journalctl -u jenkins.service`。

- Populate `/lib/systemd/system/jenkins.service` with configuration parameters for the launch, e.g `JENKINS_HOME`
   `/lib/systemd/system/jenkins.service` 填充启动项的配置参数，例如 `JENKINS_HOME`
   
- 设置 Jenkins 监听 8080 端口。使用浏览器访问此端口以开始配置。

  如果 Jenkins 因端口正在使用而无法启动，请运行 `systemctl edit jenkins` 并添加以下内容：  `[Service] Environment="JENKINS_PORT=8081"`

  这里选择了 “8081”，但可以放置另一个可用的端口。

#### Java 的安装

Jenkins 需要 Java 才能运行，但默认情况下并非所有 Linux 发行版都包含 Java。此外，[并非所有 Java 版本都](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)与 Jenkins 兼容。

可以使用多种 Java 实现。[OpenJDK](https://openjdk.java.net/) 是目前最流行的一种。

更新 Debian apt 存储库，安装 OpenJDK 17，并使用以下命令检查安装：

```bash
sudo apt update
sudo apt install fontconfig openjdk-17-jre
java -version
openjdk version "17.0.8" 2023-07-18
OpenJDK Runtime Environment (build 17.0.8+7-Debian-1deb12u1)
OpenJDK 64-Bit Server VM (build 17.0.8+7-Debian-1deb12u1, mixed mode, sharing)
```

> 为什么使用 `apt` 而不是 `apt-get` 或其他命令？apt 命令自 2014 年以来一直可用。它具有类似于 `apt-get` 的命令结构，但旨在为典型用户提供更愉快的体验。使用 `apt` 可以更轻松地完成简单的软件管理任务，例如安装、搜索和删除。

### Fedora

You can install Jenkins through `dnf`. You need to add the Jenkins repository from the Jenkins website to the package manager first.
您可以通过 `dnf` 安装 Jenkins。您需要先将 Jenkins 网站中的 Jenkins 存储库添加到包管理器中。

### Long Term Support release 长期支持版本

A [LTS (Long-Term Support) release](https://www.jenkins.io/download/lts/) is chosen every 12 weeks from the stream of regular releases as the stable release for that time period. It can be installed from the [`redhat-stable`](https://pkg.jenkins.io/redhat-stable/) yum repository.
每 12 周从常规版本流中选择一个 [LTS（长期支持）版本](https://www.jenkins.io/download/lts/)作为该时间段的稳定版本。它可以从 [`redhat-stable`](https://pkg.jenkins.io/redhat-stable/) yum 存储库安装。

```
sudo wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
sudo dnf upgrade
# Add required dependencies for the jenkins package
sudo dnf install fontconfig java-17-openjdk
sudo dnf install jenkins
sudo systemctl daemon-reload
```

### Weekly release 每周发布

A new release is produced weekly to deliver bug fixes and features to users and plugin developers. It can be installed from the [`redhat`](https://pkg.jenkins.io/redhat/) yum repository.
每周都会生成一个新版本，以向用户和插件开发人员提供错误修复和功能。它可以从 [`redhat`](https://pkg.jenkins.io/redhat/) yum 存储库安装。

```
sudo wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat/jenkins.io-2023.key
sudo dnf upgrade
# Add required dependencies for the jenkins package
sudo dnf install fontconfig java-17-openjdk
sudo dnf install jenkins
```

### Start Jenkins 启动 Jenkins

You can enable the Jenkins service to start at boot with the command:
您可以使用以下命令使 Jenkins 服务在启动时启动：

```
sudo systemctl enable jenkins
```

You can start the Jenkins service with the command:
您可以使用以下命令启动 Jenkins 服务：

```
sudo systemctl start jenkins
```

You can check the status of the Jenkins service using the command:
您可以使用以下命令检查 Jenkins 服务的状态：

```
sudo systemctl status jenkins
```

If everything has been set up correctly, you should see an output like this:
如果所有内容都已正确设置，您应该会看到如下输出：

```
Loaded: loaded (/lib/systemd/system/jenkins.service; enabled; vendor preset: enabled)
Active: active (running) since Tue 2018-11-13 16:19:01 +03; 4min 57s ago
```

|      | If you have a firewall installed, you must add Jenkins as an exception. You must change `YOURPORT` in the script below to the port you want to use. Port `8080` is the most common. 如果安装了防火墙，则必须将 Jenkins 添加为例外。您必须将下面脚本中的 `YOURPORT` 更改为要使用的端口。端口 `8080` 是最常见的。  `YOURPORT=8080 PERM="--permanent" SERV="$PERM --service=jenkins" firewall-cmd $PERM --new-service=jenkins firewall-cmd $SERV --set-short="Jenkins ports" firewall-cmd $SERV --set-description="Jenkins port exceptions" firewall-cmd $SERV --add-port=$YOURPORT/tcp firewall-cmd $PERM --add-service=jenkins firewall-cmd --zone=public --add-service=http --permanent firewall-cmd --reload` |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### Red Hat/Alma/Rocky

You can install Jenkins through `yum` on Red Hat Enterprise Linux, Alma Linux, Rocky Linux, Oracle Linux, and other Red Hat based distributions.
您可以通过 `yum` 在 Red Hat Enterprise Linux、Alma Linux、Rocky Linux、Oracle Linux 和其他基于 Red Hat 的发行版上安装 Jenkins。

How To Install Jenkins on Rocky Linux 9
如何在 Rocky Linux 9 上安装 Jenkins

You need to choose either the Jenkins Long Term Support release or the Jenkins weekly release.
您需要选择 Jenkins 长期支持版本或 Jenkins 每周版本。

### Long Term Support release 长期支持版本

A [LTS (Long-Term Support) release](https://www.jenkins.io/download/lts/) is chosen every 12 weeks from the stream of regular releases as the stable release for that time period. It can be installed from the [`redhat-stable`](https://pkg.jenkins.io/redhat-stable/) yum repository.
每 12 周从常规版本流中选择一个 [LTS（长期支持）版本](https://www.jenkins.io/download/lts/)作为该时间段的稳定版本。它可以从 [`redhat-stable`](https://pkg.jenkins.io/redhat-stable/) yum 存储库安装。

```
sudo wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
sudo yum upgrade
# Add required dependencies for the jenkins package
sudo yum install fontconfig java-17-openjdk
sudo yum install jenkins
sudo systemctl daemon-reload
```

### Weekly release 每周发布

A new release is produced weekly to deliver bug fixes and features to users and plugin developers. It can be installed from the [`redhat`](https://pkg.jenkins.io/redhat/) yum repository.
每周都会生成一个新版本，以向用户和插件开发人员提供错误修复和功能。它可以从 [`redhat`](https://pkg.jenkins.io/redhat/) yum 存储库安装。

```
sudo wget -O /etc/yum.repos.d/jenkins.repo \
    https://pkg.jenkins.io/redhat/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat/jenkins.io-2023.key
sudo yum upgrade
# Add required dependencies for the jenkins package
sudo yum install fontconfig java-17-openjdk
sudo yum install jenkins
```

### Start Jenkins 启动 Jenkins

You can enable the Jenkins service to start at boot with the command:
您可以使用以下命令使 Jenkins 服务在启动时启动：

```
sudo systemctl enable jenkins
```

You can start the Jenkins service with the command:
您可以使用以下命令启动 Jenkins 服务：

```
sudo systemctl start jenkins
```

You can check the status of the Jenkins service using the command:
您可以使用以下命令检查 Jenkins 服务的状态：

```
sudo systemctl status jenkins
```

If everything has been set up correctly, you should see an output like this:
如果所有内容都已正确设置，您应该会看到如下输出：

```
Loaded: loaded (/lib/systemd/system/jenkins.service; enabled; vendor preset: enabled)
Active: active (running) since Tue 2023-06-22 16:19:01 +03; 4min 57s ago
...
```

|      | If you have a firewall installed, you must add Jenkins as an exception. You must change `YOURPORT` in the script below to the port you want to use. Port `8080` is the most common. 如果安装了防火墙，则必须将 Jenkins 添加为例外。您必须将下面脚本中的 `YOURPORT` 更改为要使用的端口。端口 `8080` 是最常见的。  `YOURPORT=8080 PERM="--permanent" SERV="$PERM --service=jenkins" firewall-cmd $PERM --new-service=jenkins firewall-cmd $SERV --set-short="Jenkins ports" firewall-cmd $SERV --set-description="Jenkins port exceptions" firewall-cmd $SERV --add-port=$YOURPORT/tcp firewall-cmd $PERM --add-service=jenkins firewall-cmd --zone=public --add-service=http --permanent firewall-cmd --reload` |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### 安装后配置向导

运行 Jenkins 后（使用 Jenkins Operator Jenkins 操作员进行安装除外），安装后设置向导将开始。

此设置向导将引导完成一些快速的“一次性”步骤来解锁  Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，可以通过该用户继续访问 Jenkins。

#### 解锁 Jenkins

当首次访问新的 Jenkins 控制器时，系统会要求使用自动生成的密码解锁它。

1. 浏览到 `http://localhost:8080`（或在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。
   
   ![](../../Image/s/setup-jenkins-01-unlock-jenkins-page.jpg)
   
2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![](../../Image/s/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - 命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - 如果使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 在控制台中打印密码，而无需执行到容器中。
   
3. 在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**
   
   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

#### 使用插件自定义 Jenkins

[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/linux/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，可以安装任意数量的有用插件作为初始设置的一部分。

单击显示的两个选项之一：

- **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

> 如果不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。可以在以后的某个时间点通过 Jenkins 中的  [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。

设置向导显示正在配置 Jenkins 的进度以及选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

#### 创建第一个管理员用户

最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/linux/#customizing-jenkins-with-plugins) 后，Jenkins 会要求创建第一个管理员用户。

1. 当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. 当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - 如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. 如果需要，请使用刚刚创建的用户的凭证登录 Jenkins，然后就可以开始使用 Jenkins 了！

# macOS

The macOS installer for Jenkins is maintained outside the Jenkins project. Refer to documentation based on the version of Jenkins to be run.
Jenkins 的 macOS 安装程序在 Jenkins 项目外部进行维护。根据要运行的 Jenkins 版本参考文档。

- [Installing Jenkins LTS on macOS
  在 macOS 上安装 Jenkins LTS](https://www.jenkins.io/download/lts/macos)
- [Installing Jenkins Weekly on macOS
  在 macOS 上安装 Jenkins Weekly](https://www.jenkins.io/download/weekly/macos)

## Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

### Unlocking Jenkins 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

### Customizing Jenkins with plugins 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/macos/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/macos/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

### Creating the first administrator user 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/macos/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/macos/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

# Windows 窗户

Table of Contents 目录

- [Prerequisites 先决条件](https://www.jenkins.io/doc/book/installing/windows/#prerequisites)
- [Installation steps using Windows MSI installer
  使用 Windows MSI 安装程序的安装步骤](https://www.jenkins.io/doc/book/installing/windows/#windows-msi-installers)
- [Silent Install with the MSI installers
  使用 MSI 安装程序进行静默安装](https://www.jenkins.io/doc/book/installing/windows/#silent-install-with-the-msi-installers)
- Post-installation setup wizard
  安装后安装向导
  - [Unlocking Jenkins 解锁 Jenkins](https://www.jenkins.io/doc/book/installing/windows/#unlocking-jenkins)
  - [Customizing Jenkins with plugins
    使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/windows/#customizing-jenkins-with-plugins)
  - [Creating the first administrator user
    创建第一个管理员用户](https://www.jenkins.io/doc/book/installing/windows/#creating-the-first-administrator-user)
- Troubleshooting Windows installation
  Windows 安装疑难解答
  - [Invalid service logon credentials
    服务登录凭据无效](https://www.jenkins.io/doc/book/installing/windows/#invalid-service-logon-credentials)

The simplest way to install Jenkins on Windows is to use the Jenkins Windows installer. That program will install Jenkins as a service using a 64 bit JVM chosen by the user. Keep in mind that to run Jenkins as a service, the account that runs Jenkins must have permission to login as a service.
在 Windows 上安装 Jenkins 的最简单方法是使用 Jenkins Windows 安装程序。该程序将使用用户选择的 64 位 JVM 将 Jenkins 安装为服务。请记住，要将 Jenkins 作为服务运行，运行 Jenkins 的账户必须具有作为服务登录的权限。

## Prerequisites 先决条件

Minimum hardware requirements:
最低硬件要求：

- 256 MB of RAM 256 MB 的内存
- 1 GB of drive space (although 10 GB is a recommended minimum if running Jenkins as a Docker container)
  1 GB 的驱动器空间（但如果将 Jenkins 作为 Docker 容器运行，建议至少为 10 GB）

Recommended hardware configuration for a small team:
小型团队的推荐硬件配置：

- 4 GB+ of RAM 4 GB+ 的 RAM
- 50 GB+ of drive space
  50 GB+ 的驱动器空间

Comprehensive hardware recommendations:
全面的硬件建议：

- Hardware: see the [Hardware Recommendations](https://www.jenkins.io/doc/book/scaling/hardware-recommendations) page
  硬件：请参阅[硬件建议](https://www.jenkins.io/doc/book/scaling/hardware-recommendations)页面

Software requirements: 软件要求：

- Java: see the [Java Requirements](https://www.jenkins.io/doc/book/platform-information/support-policy-java/) page
  Java：请参阅 [Java 要求](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)页面
- Web browser: see the [Web Browser Compatibility](https://www.jenkins.io/doc/administration/requirements/web-browsers/) page
  Web 浏览器：请参阅 [Web 浏览器兼容性](https://www.jenkins.io/doc/administration/requirements/web-browsers/)页面
- For Windows operating system: [Windows Support Policy](https://www.jenkins.io/doc/administration/requirements/windows/)
  对于 Windows 操作系统：[Windows 支持策略](https://www.jenkins.io/doc/administration/requirements/windows/)
- For Linux operating system: [Linux Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
  对于 Linux 操作系统：[Linux 支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
- For servlet containers: [Servlet Container Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)
  对于 Servlet 容器：[Servlet 容器支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)

## Installation steps using Windows MSI installer 使用 Windows MSI 安装程序的安装步骤

How to install Jenkins on Windows

<iframe width="682" height="384" src="https://www.youtube.com/embed/XuMrEDA8cAI?rel=0" frameborder="0" allowfullscreen=""></iframe>

Refer to the Windows section of the [Downloading Jenkins](https://www.jenkins.io/download/#downloading-jenkins) page to download either an LTS release or a weekly release of the Windows installer. After the download completes, open the Windows installer and follow the steps below to install Jenkins.
请参阅[下载 Jenkins](https://www.jenkins.io/download/#downloading-jenkins) 页面的 Windows 部分，下载 Windows 安装程序的 LTS 版本或每周版本。下载完成后，打开 Windows 安装程序并按照以下步骤安装 Jenkins。

- Step 1: Setup wizard 第 1 步：设置向导

  On opening the Windows Installer, an **Installation Setup Wizard** appears, Click **Next** on the Setup Wizard to start your installation. 打开 Windows 安装程序时，会出现**一个安装设置向导**，单击安装向导上的**下一步**开始安装。

![Windows Installation Setup Wizard](https://www.jenkins.io/doc/book/resources/tutorials/windows-installation-setup-wizard.png)

- Step 2: Select destination folder 步骤 2：选择目标文件夹

  Select the destination folder to store your Jenkins Installation and click **Next** to continue. 选择用于存储 Jenkins 安装的目标文件夹，然后单击 **Next** 继续。

![Jenkins Installation Destination](https://www.jenkins.io/doc/book/resources/tutorials/windows-installation-destination.png)

- Step 3: Service logon credentials 步骤 3：服务登录凭据

  When Installing Jenkins, it is recommended to install and run Jenkins as an independent windows service using a **local or domain user** as it is much safer than running Jenkins using **LocalSystem(Windows equivalent of root)** which will grant Jenkins full access to your machine and services. 安装 Jenkins 时，建议使用**本地或域用户**将 Jenkins 作为独立的 Windows 服务安装和运行，因为它比使用 **LocalSystem（相当于 Windows**）运行 Jenkins 安全得多，后者将授予 Jenkins 对您的计算机和服务的完全访问权限。

To run Jenkins service using a **local or domain user**, specify the domain user name and password with which you want to run Jenkins, click on **Test Credentials** to test your domain credentials and click on **Next**.
要使用**本地或域用户**运行 Jenkins 服务，请指定要用于运行 Jenkins 的域用户名和密码，单击 **Test Credentials （测试凭证**） 以测试您的域凭证，然后单击 **Next （下一步**）。

![Jenkins Service Logon Credentials](https://www.jenkins.io/doc/book/resources/tutorials/windows-jenkins-logon-credentials.png)

|      | If you get **Invalid Logon** Error pop-up while trying to test your credentials, follow the steps explained [here](https://www.jenkins.io/doc/book/installing/windows/#invalid-service-logon-credentials) to resolve it.  如果您在尝试测试凭据时收到 **Invalid Logon** Error 弹出窗口，请按照[此处](https://www.jenkins.io/doc/book/installing/windows/#invalid-service-logon-credentials)说明的步骤进行解决。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

- Step 4: Port selection 第 4 步：端口选择

  Specify the port on which Jenkins will be running, **Test Port** button to validate whether the specified port if free on your machine or not. Consequently, if the port is free, it will show a green tick mark as shown below, then click on **Next**. 指定 Jenkins 将在其上运行的端口，在 **Test Port （测试端口**） 按钮上验证指定的端口在您的计算机上是否可用。因此，如果端口是空闲的，它将显示一个绿色的勾号，如下所示，然后单击**下一步**。

![Jenkins Select Port](https://www.jenkins.io/doc/book/resources/tutorials/windows-select-port.png)

- Step 5: Select Java home directory 第 5 步：选择 Java 主目录

  The installation process checks for Java on your machine and prefills the dialog with the Java home directory. If the needed Java version is not installed on your machine, you will be prompted to install it. 安装过程将检查计算机上的 Java，并使用 Java 主目录预填充对话框。如果您的计算机上未安装所需的 Java 版本，系统将提示您安装它。

Once your Java home directory has been selected, click on **Next** to continue.
选择 Java 主目录后，单击 **Next** 继续。

![Select Java Home Directory](https://www.jenkins.io/doc/book/resources/tutorials/windows-select-jdk-installation.png)

- Step 6: Custom setup 第 6 步：自定义设置

  Select other services that need to be installed with Jenkins and click on **Next**. 选择需要使用 Jenkins 安装的其他服务，然后单击 **Next**。

![Jenkins Custom Setup](https://www.jenkins.io/doc/book/resources/tutorials/windows-select-features-to-install.png)

- Step 7: Install Jenkins 第 7 步：安装 Jenkins

  Click on the **Install** button to start the installation of Jenkins. 单击 **Install** 按钮开始安装 Jenkins。

![Windows Install Jenkins](https://www.jenkins.io/doc/book/resources/tutorials/windows-install.png)

Additionally, clicking on the **Install** button will show the progress bar of installation, as shown below:
此外，单击 **Install** 按钮将显示安装进度条，如下所示：

![Windows Installation Progress](https://www.jenkins.io/doc/book/resources/tutorials/windows-installation-progress.png)

- Step 8: Finish Jenkins installation 第 8 步：完成 Jenkins 安装

  Once the installation completes, click on **Finish** to complete the installation. 安装完成后，单击 **Finish** 完成安装。

![Finish Install](https://www.jenkins.io/doc/book/resources/tutorials/windows-finish-install.png)

Jenkins will be installed as a **Windows Service**. You can validate this by browsing the **services** section, as shown below:
Jenkins 将作为 **Windows 服务**安装。您可以通过浏览 **services** 部分来验证这一点，如下所示：

![Windows Jenkins Service](https://www.jenkins.io/doc/book/resources/tutorials/windows-jenkins-service.png)

|      | See the [upgrade steps](https://www.jenkins.io/blog/2020/08/12/windows-installers-upgrade/#next-steps) when you upgrade to a new release.  在升级到新版本时，请参阅[升级步骤](https://www.jenkins.io/blog/2020/08/12/windows-installers-upgrade/#next-steps)。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

## Silent Install with the MSI installers 使用 MSI 安装程序进行静默安装

MSI installers can be installed via a silent method, which can show basic  UI (/qb) or no UI at all (/qn). The silent method does not prompt for  user input so there are properties that you can pass to the installer to set the specific values. A very basic command line is shown below for a silent install.
MSI 安装程序可以通过静默方法安装，该方法可以显示基本 UI （/qb） 或根本不显示 UI （/qn）。silent 方法不会提示用户输入，因此您可以将一些属性传递给安装程序以设置特定值。下面显示了一个非常基本的命令行，用于静默安装。

```
msiexec.exe /i "path\to\jenkins.msi" /qn /norestart
```

This will use all of the default values for things that would normally be a prompt such as:
这将对通常作为提示的事物使用所有默认值，例如：

- Installation directory 安装目录
- Service account username/password
  服务帐户用户名/密码
- Java installation directory
  Java 安装目录
- The port for Jenkins to listen on
  Jenkins 要侦听的端口

Each of these things can be overridden by passing a `NAME=VALUE` property pair for what you want to override:
通过为要覆盖的内容传递 `NAME=VALUE` 属性对，可以覆盖这些内容中的每一个：

| Property Name 属性名称 | Description 描述                                             |
| ---------------------- | ------------------------------------------------------------ |
| INSTALLDIR             | Path to the directory to install Jenkins. (Default: C:\Program Files\Jenkins) 安装 Jenkins 的目录路径。（默认值：C：\Program Files\Jenkins） |
| PORT                   | The port Jenkins will listen on. (Default: 8080) Jenkins 将侦听的端口。（默认值：8080） |
| JAVA_HOME              | The directory where java.exe can be found. (Default: The latest recommended Java runtime found in the registry) 可以找到 java.exe 的目录。（默认：在注册表中找到的最新推荐 Java 运行时） |
| SERVICE_USERNAME       | The username that the service should run as. The account must have  LogonAsService permissions. (Default: In silent mode, the LOCALSYSTEM  account) 服务应使用的用户名。该帐户必须具有 LogonAsService 权限。（默认值：在静默模式下，LOCALSYSTEM 帐户） |
| SERVICE_PASSWORD       | The password for the SERVICE_USERNAME account. This should only be provided if SERVICE_USERNAME is provided. (Default: In silent mode, none for  LOCALSYSTEM) SERVICE_USERNAME 账户的密码。只有在提供 SERVICE_USERNAME 时，才应提供此 ID。（默认值：在静默模式下，LOCALSYSTEM 无） |

A more complex example, including the creation of a log file for the installation process is shown below:
下面显示了一个更复杂的示例，包括为安装过程创建日志文件：

```
msiexec.exe /i "path\to\jenkins.msi" /qn /norestart INSTALLDIR="D:\Jenkins" JAVA_HOME="C:\Program Files\SomeJava" PORT=80 /L*v "path\to\logfile.txt"
```

This would install Jenkins into D:\Jenkins, use the Java runtime from  C:\Program Files\SomeJava and Jenkins would be listening on port 80.
这会将 Jenkins 安装到 D：\Jenkins 中，使用 C：\Program Files\SomeJava 中的 Java 运行时，并且 Jenkins 将侦听端口 80。

## Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins, the post-installation setup wizard begins.
下载、安装并运行 Jenkins 后，安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

### Unlocking Jenkins 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

- Step 1 第 1 步

  Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears. 浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-unlock-jenkins-page.png)

- Step 2 步骤 2

  The initial Administrator password should be found under the Jenkins installation path (set at Step 2 in Jenkins Installation). 初始管理员密码应在 Jenkins 安装路径下找到（在 Jenkins 安装的步骤 2 中设置）。

For default installation location to C:\Program Files\Jenkins, a file called **initialAdminPassword** can be found under C:\Program Files\Jenkins\secrets.
对于 C：\Program Files\Jenkins 的默认安装位置，可以在 C：\Program Files\Jenkins\secrets 下找到名为 **initialAdminPassword** 的文件。

However, If a custom path for Jenkins installation was selected, then you should check that location for **initialAdminPassword** file.
但是，如果选择了 Jenkins 安装的自定义路径，则应检查该位置的 **initialAdminPassword** 文件。

![Jenkins Initial Password Location](https://www.jenkins.io/doc/book/resources/tutorials/windows-initial-password-location.png)

- Step 3 步骤 3

  Open the highlighted file and copy the content of the **initialAdminPassword** file. 打开高亮显示的文件并复制 **initialAdminPassword** 文件的内容。

![Jenkins Initial Password File](https://www.jenkins.io/doc/book/resources/tutorials/windows-initial-password-file.png)

- Step 4 步骤 4

  On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**. 在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。   **Notes: 笔记：**  You can also access Jenkins logs in the **jenkins.err.log** file in your Jenkins directory specified during the installation. 您还可以访问安装期间指定的 Jenkins 目录中的 **jenkins.err.log** 文件中的 Jenkins 日志。  The Jenkins log file is another location (in the Jenkins home directory) where the initial password can also be obtained. Jenkins 日志文件是另一个位置（在 Jenkins 主目录中），也可以在其中获取初始密码。   ![Windows Jenkins Log File](https://www.jenkins.io/doc/book/resources/tutorials/windows-jenkins-log.png)

This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问 Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

### Customizing Jenkins with plugins 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/windows/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/windows/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

### Creating the first administrator user 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/windows/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/windows/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

## Troubleshooting Windows installation Windows 安装疑难解答

### Invalid service logon credentials 服务登录凭据无效

![Invalid Service Logon Credentials](https://www.jenkins.io/doc/book/resources/tutorials/windows-invalid-service-logon-credentials.png)

When installing a service to run under a domain user account, the account  must have the right to logon as a service. This logon permission applies strictly to the local computer and must be granted in the Local  Security Policy.
在安装要在域用户帐户下运行的服务时，该帐户必须具有作为服务登录的权限。此登录权限严格适用于本地计算机，并且必须在本地安全策略中授予。

Perform the following steps below to edit the Local Security Policy of the  computer you want to define the ‘logon as a service’ permission:
执行以下步骤以编辑要定义“作为服务登录”权限的计算机的本地安全策略：

1. Logon to the computer with administrative privileges.
   使用管理权限登录到计算机。
2. Open the **Administrative Tools** and open the **Local Security Policy**
   打开 **管理工具** 并打开 **本地安全策略**
3. If the **Local Security Policy** is missing in your system, refer to the answer in the [Where to download GPEdit.msc for Windows 10 Home?](https://answers.microsoft.com/en-us/windows/forum/all/where-to-download-gpeditmsc-for-windows-10-home/c39bd656-8d4a-4374-be39-394c09deec4e) question on Microsoft Community to troubleshoot
   如果您的系统中缺少**本地安全策略**，请参阅 Microsoft 社区上[“在哪里下载适用于 Windows 10 家庭版的 GPEdit.msc？](https://answers.microsoft.com/en-us/windows/forum/all/where-to-download-gpeditmsc-for-windows-10-home/c39bd656-8d4a-4374-be39-394c09deec4e)”问题中的答案以进行故障排除
4. Expand **Local Policy** and click on **User Rights Assignment**
   展开 **Local Policy** 并单击 **User Rights Assignment**
5. In the right pane, right-click **Log on as a service** and select properties.
   在右窗格中，右键单击 **Log on as a service** 并选择 properties.
6. Click on the **Add User or Group…** button to add the new user.
   单击 **Add User or Group...（添加用户或组...）**按钮以添加新用户。
7. In the **Select Users or Groups** dialogue, find the user you wish to enter and click **OK**
   在 **Select Users or Groups** 对话框中，找到要输入的用户，然后单击 **OK**
8. Click **OK** in the **Log on as a service Properties** to save changes.
   在 **Log on as a service Properties** 中单击 **OK** 以保存更改。

After completing the steps above, try logging in again with the added user.
完成上述步骤后，尝试使用添加的用户再次登录。

# Other Systems 其他系统

Table of Contents 目录

- FreeBSD FreeBSD 软件
  - [Long Term Support release
    长期支持版本](https://www.jenkins.io/doc/book/installing/other/#long-term-support-release)
  - [Weekly release 每周发布](https://www.jenkins.io/doc/book/installing/other/#weekly-release)
  - [Start Jenkins 启动 Jenkins](https://www.jenkins.io/doc/book/installing/other/#start-jenkins)
  - [Enable Jenkins 启用 Jenkins](https://www.jenkins.io/doc/book/installing/other/#enable-jenkins)
- [OpenIndiana Hipster OpenIndiana 时髦人士](https://www.jenkins.io/doc/book/installing/other/#openindiana-hipster)
- [Solaris, OmniOS, SmartOS, and other siblings
  Solaris、OmniOS、SmartOS 和其他同级](https://www.jenkins.io/doc/book/installing/other/#solaris-omnios-smartos-and-other-siblings)
- Post-installation setup wizard
  安装后安装向导
  - [Unlocking Jenkins 解锁 Jenkins](https://www.jenkins.io/doc/book/installing/other/#unlocking-jenkins)
  - [Customizing Jenkins with plugins
    使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/other/#customizing-jenkins-with-plugins)
  - [Creating the first administrator user
    创建第一个管理员用户](https://www.jenkins.io/doc/book/installing/other/#creating-the-first-administrator-user)

## FreeBSD FreeBSD 软件

Jenkins can be installed on FreeBSD using the standard FreeBSD package manager, `pkg`.
Jenkins 可以使用标准的 FreeBSD 包管理器 `pkg` 安装在 FreeBSD 上。

### Long Term Support release 长期支持版本

A [LTS (Long-Term Support) release](https://www.jenkins.io/download/lts/) is chosen every 12 weeks from the stream of regular releases as the stable release for that time period. It can be installed from the FreeBSD `pkg` package manager.
每 12 周从常规版本流中选择一个 [LTS（长期支持）版本](https://www.jenkins.io/download/lts/)作为该时间段的稳定版本。它可以从 FreeBSD `pkg` 包管理器安装。

```
# pkg install jenkins-lts
```

|      | Disclaimer: The [FreeBSD project](https://www.freebsd.org/) maintains the Jenkins packaging for FreeBSD. The Jenkins package for FreeBSD is NOT officially supported by the Jenkins project, but it is actively used by the [FreeBSD project](https://www.freebsd.org/) at [ci.freebsd.org/](https://ci.freebsd.org/) . 免责声明：[FreeBSD 项目](https://www.freebsd.org/)维护着 FreeBSD 的 Jenkins 打包。Jenkins 项目并未正式支持 FreeBSD 的 Jenkins 包，但 [ci.freebsd.org/](https://ci.freebsd.org/) 的 [FreeBSD 项目](https://www.freebsd.org/)积极使用它。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### Weekly release 每周发布

A new release is produced weekly to deliver bug fixes and features to users and plugin developers. It can be installed from the FreeBSD `pkg` package manager.
每周都会生成一个新版本，以向用户和插件开发人员提供错误修复和功能。它可以从 FreeBSD `pkg` 包管理器安装。

```
# pkg install jenkins
```

The long term support package `jenkins-lts` and the weekly package installation `jenkins` will:
长期支持包 `jenkins-lts` 和每周包安装 `jenkins` 将：

- Configure Jenkins as a daemon which may optionally be launched on start. See `/etc/rc.conf` for more details
  将 Jenkins 配置为守护程序，可以选择在启动时启动。有关更多详细信息，请参见 `/etc/rc.conf`
- Create a ‘jenkins’ user to run the service
  创建一个 'jenkins' 用户来运行服务
- Direct console log output to the file `/var/log/jenkins.log`. Check this file when troubleshooting Jenkins
  将控制台日志输出直接输出到文件 `/var/log/jenkins.log`。对 Jenkins 进行故障排除时检查此文件
- Set Jenkins to listen on port 8180 from the path `/jenkins`.  Open http://localhost:8180/jenkins to login to Jenkins
  将 Jenkins 设置为从路径 `/jenkins` 侦听端口 8180。打开 http://localhost:8180/jenkins 以登录到 Jenkins

### Start Jenkins 启动 Jenkins

You can start the Jenkins service with the command:
您可以使用以下命令启动 Jenkins 服务：

```
# service jenkins onestart
```

You can check the status of the Jenkins service using the command:
您可以使用以下命令检查 Jenkins 服务的状态：

```
# service jenkins status
```

You can stop the Jenkins service with the command:
您可以使用以下命令停止 Jenkins 服务：

```
# service jenkins stop
```

### Enable Jenkins 启用 Jenkins

Add the following to `/etc/rc.conf` to start Jenkins automatically on system boot:
将以下内容添加到 `/etc/rc.conf` 中，以便在系统启动时自动启动 Jenkins：

```
jenkins_enable="YES"
```

Once Jenkins is enabled, it can be started with:
启用 Jenkins 后，可以使用以下命令启动它：

```
# service jenkins start
```

Other configuration values that can be set in `/etc/rc.conf` or in `/etc/rc.conf.d/jenkins` are described in `/usr/local/etc/rc.d/jenkins`. Refer to the [Jenkins page](https://wiki.freebsd.org/Jenkins) on the [FreeBSD wiki](https://wiki.freebsd.org/) for more information specific to Jenkins on FreeBSD.
可以在 `/etc/rc.conf` 或 `/etc/rc.conf.d/jenkins` 中设置的其他配置值在 `/usr/local/etc/rc.d/jenkins` 中描述。请参阅 [FreeBSD wiki](https://wiki.freebsd.org/) 上的 [Jenkins 页面](https://wiki.freebsd.org/Jenkins)，了解有关 FreeBSD 上的 Jenkins 的更多信息。

## OpenIndiana Hipster OpenIndiana 时髦人士

On a system running [OpenIndiana Hipster](https://www.openindiana.org/) Jenkins can be installed in either the local or global zone using the [Image Packaging System](https://en.wikipedia.org/wiki/Image_Packaging_System) (IPS).
在运行 [OpenIndiana](https://www.openindiana.org/) 的系统上，可以使用[映像包管理系统](https://en.wikipedia.org/wiki/Image_Packaging_System) （IPS） 将 Jenkins 安装在本地或全局区域中。

|      | Disclaimer: This platform is NOT officially supported by the Jenkins team, use it at your own risk. Packaging and integration described in this section is maintained by the OpenIndiana Hipster team, bundling the generic `jenkins.war` to work in that operating environment. 免责声明：此平台不受 Jenkins 团队的官方支持，使用风险自负。本节中描述的打包和集成由 OpenIndiana Hipster 团队维护，捆绑通用 `jenkins.war` 以在该操作环境中工作。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

For the common case of running the newest packaged weekly build as a standalone (Jetty) server, simply execute:
对于将最新打包的每周构建作为独立 （Jetty） 服务器运行的常见情况，只需执行：

```
pkg install jenkins
svcadm enable jenkins
```

The common packaging integration for a standalone service will:
独立服务的通用打包集成将：

- Create a `jenkins` user to run the service and to own the directory structures under `/var/lib/jenkins`.
  创建一个 `jenkins` 用户来运行服务并拥有 `/var/lib/jenkins` 下的目录结构。
- Pull the Java package and other packages required to execute Jenkins, including the `jenkins-core-weekly` package with the latest `jenkins.war`.
  拉取执行 Jenkins 所需的 Java 包和其他包，包括包含最新 `jenkins.war` 的 `jenkins-core-weekly` 包。
- Set up Jenkins as an SMF service instance (`svc:/network/http:jenkins`) which can then be enabled with the `svcadm` command demonstrated above.
  将 Jenkins 设置为 SMF 服务实例 （`svc：/network/http：jenkins`），然后可以使用上面演示的 `svcadm` 命令启用该实例。
- Set up Jenkins to listen on port 8080.
  设置 Jenkins 以侦听端口 8080。
- Configure the log output to be managed by SMF at `/var/svc/log/network-http:jenkins.log`.
  将日志输出配置为由 SMF 在 `/var/svc/log/network-http:jenkins.log` 上管理。

Once Jenkins is running, consult the log (`/var/svc/log/network-http:jenkins.log`) to retrieve the generated administrator password for the initial set up of Jenkins, usually it will be found at `/var/lib/jenkins/home/secrets/initialAdminPassword`. Then navigate to [localhost:8080](http://localhost:8080) to [complete configuration of the Jenkins controller](https://www.jenkins.io/doc/book/installing/other/#setup-wizard).
Jenkins 运行后，请查阅日志 （） `/var/svc/log/network-http:jenkins.log` 以检索为 Jenkins 初始设置生成的管理员密码，该密码通常位于 `/var/lib/jenkins/home/secrets/initialAdminPassword` 。然后导航到 [localhost：8080](http://localhost:8080) [以完成 Jenkins 控制器的配置](https://www.jenkins.io/doc/book/installing/other/#setup-wizard)。

To change attributes of the service, such as environment variables like `JENKINS_HOME` or the port number used for the Jetty web server, use the `svccfg` utility:
要更改服务的属性，例如环境变量（如 `JENKINS_HOME` 或用于 Jetty Web 服务器的端口号），请使用 `svccfg` 实用程序：

```
svccfg -s svc:/network/http:jenkins editprop
svcadm refresh svc:/network/http:jenkins
```

You can also refer to `/lib/svc/manifest/network/jenkins-standalone.xml` for more details and comments about currently supported tunables of the SMF service. Note that the `jenkins` user account created by the packaging is specially privileged to allow binding to port numbers under 1024.
您还可以参阅 `/lib/svc/manifest/network/jenkins-standalone.xml` 有关 SMF 服务当前支持的可调参数的更多详细信息和注释。请注意，打包创建的 `jenkins` 用户帐户具有特殊权限，允许绑定到 1024 以下的端口号。

The current status of Jenkins-related packages available for the given release of OpenIndiana can be queried with:
可以使用以下方法查询给定版本的 OpenIndiana 可用的 Jenkins 相关软件包的当前状态：

```
pkg info -r '*jenkins*'
```

Upgrades to the package can be performed by updating the entire operating environment with `pkg update`, or specifically for Jenkins core software with:
可以通过使用 `pkg update` 更新整个操作环境来执行对软件包的升级，或者专门针对 Jenkins 核心软件使用以下命令进行升级：

```
pkg update jenkins-core-weekly
```

|      | Procedure for updating the package will restart the currently running Jenkins process. Make sure to prepare it for shutdown and finish all running jobs before updating, if needed. 更新软件包的过程将重新启动当前正在运行的 Jenkins 进程。确保为关闭做好准备，并在需要时在更新之前完成所有正在运行的作业。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

## Solaris, OmniOS, SmartOS, and other siblings Solaris、OmniOS、SmartOS 和其他同级

Generally it should suffice to install a [supported Java version](https://www.jenkins.io/doc/book/platform-information/support-policy-java/), [download](https://www.jenkins.io/download) the `jenkins.war`, and run it as a standalone process.
通常，安装[受支持的 Java 版本](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)，[下载](https://www.jenkins.io/download) `jenkins.war` 并将其作为独立进程运行就足够了。

Some caveats apply: 一些注意事项适用：

- Headless JVM and fonts: For OpenJDK builds on minimalized-footprint systems, there may be [issues running the headless JVM](https://wiki.jenkins.io/display/JENKINS/Jenkins+got+java.awt.headless+problem), because Jenkins needs some fonts to render certain pages.
  无头 JVM 和字体：对于在占用空间最小的系统上构建的 OpenJDK，[运行无头 JVM 可能会出现问题](https://wiki.jenkins.io/display/JENKINS/Jenkins+got+java.awt.headless+problem)，因为 Jenkins 需要一些字体来呈现某些页面。

## Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

### Unlocking Jenkins 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

### Customizing Jenkins with plugins 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/other/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/other/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

### Creating the first administrator user 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/other/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/other/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

# WAR file WAR 文件

Table of Contents 目录

- [Prerequisites 先决条件](https://www.jenkins.io/doc/book/installing/war-file/#prerequisites)
- [Run the WAR file 运行 WAR 文件](https://www.jenkins.io/doc/book/installing/war-file/#run-the-war-file)
- Post-installation setup wizard
  安装后安装向导
  - [Unlocking Jenkins 解锁 Jenkins](https://www.jenkins.io/doc/book/installing/war-file/#unlocking-jenkins)
  - [Customizing Jenkins with plugins
    使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/war-file/#customizing-jenkins-with-plugins)
  - [Creating the first administrator user
    创建第一个管理员用户](https://www.jenkins.io/doc/book/installing/war-file/#creating-the-first-administrator-user)

The Jenkins Web application ARchive (WAR) file bundles [Winstone](https://github.com/jenkinsci/winstone), a [Jetty](https://www.eclipse.org/jetty/) servlet container wrapper, and can be started on any operating system or platform with a version of Java supported by Jenkins. See the [Java Requirements](https://www.jenkins.io/doc/book/platform-information/support-policy-java) page for details.
Jenkins Web 应用程序 ARchive （WAR） 文件捆绑了 [Winstone](https://github.com/jenkinsci/winstone)（一个 [Jetty](https://www.eclipse.org/jetty/) servlet 容器包装器），并且可以在具有 Jenkins 支持的 Java 版本的任何操作系统或平台上启动。有关详细信息，请参阅 [Java 要求](https://www.jenkins.io/doc/book/platform-information/support-policy-java)页面。

## Prerequisites 先决条件

Minimum hardware requirements:
最低硬件要求：

- 256 MB of RAM 256 MB 的内存
- 1 GB of drive space (although 10 GB is a recommended minimum if running Jenkins as a Docker container)
  1 GB 的驱动器空间（但如果将 Jenkins 作为 Docker 容器运行，建议至少为 10 GB）

Recommended hardware configuration for a small team:
小型团队的推荐硬件配置：

- 4 GB+ of RAM 4 GB+ 的 RAM
- 50 GB+ of drive space
  50 GB+ 的驱动器空间

Comprehensive hardware recommendations:
全面的硬件建议：

- Hardware: see the [Hardware Recommendations](https://www.jenkins.io/doc/book/scaling/hardware-recommendations) page
  硬件：请参阅[硬件建议](https://www.jenkins.io/doc/book/scaling/hardware-recommendations)页面

Software requirements: 软件要求：

- Java: see the [Java Requirements](https://www.jenkins.io/doc/book/platform-information/support-policy-java/) page
  Java：请参阅 [Java 要求](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)页面
- Web browser: see the [Web Browser Compatibility](https://www.jenkins.io/doc/administration/requirements/web-browsers/) page
  Web 浏览器：请参阅 [Web 浏览器兼容性](https://www.jenkins.io/doc/administration/requirements/web-browsers/)页面
- For Windows operating system: [Windows Support Policy](https://www.jenkins.io/doc/administration/requirements/windows/)
  对于 Windows 操作系统：[Windows 支持策略](https://www.jenkins.io/doc/administration/requirements/windows/)
- For Linux operating system: [Linux Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
  对于 Linux 操作系统：[Linux 支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
- For servlet containers: [Servlet Container Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)
  对于 Servlet 容器：[Servlet 容器支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)

## Run the WAR file 运行 WAR 文件

The Jenkins Web application ARchive (WAR) file can be started from the command line like this:
可以从命令行启动 Jenkins Web 应用程序 ARchive （WAR） 文件，如下所示：

1. Download the [latest Jenkins WAR file](https://www.jenkins.io/download) to an appropriate directory on your machine
   将[最新的 Jenkins WAR 文件](https://www.jenkins.io/download)下载到计算机上的适当目录
2. Open up a terminal/command prompt window to the download directory
   打开终端/命令提示符窗口到下载目录
3. Run the command `java -jar jenkins.war`
   运行命令 `java -jar jenkins.war`
4. Browse to `http://localhost:8080` and wait until the **Unlock Jenkins** page appears
   浏览到 `http://localhost:8080` 并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现
5. Continue on with the [Post-installation setup wizard](https://www.jenkins.io/doc/book/installing/war-file/#setup-wizard) below
   继续下面的[安装后设置向导](https://www.jenkins.io/doc/book/installing/war-file/#setup-wizard)

**Notes: 笔记：**

- This process does not automatically install any specific plugins. They need to installed separately via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.
  此过程不会自动安装任何特定插件。它们需要通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) [**> Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面单独安装。

- You can change the port by specifying the `--httpPort` option when you run the `java -jar jenkins.war` command. For example, to make Jenkins accessible through port 9090, then run Jenkins using the command:
  您可以通过在运行 `java -jar jenkins.war` 命令时指定 `--httpPort` 选项来更改端口。例如，要使 Jenkins 可通过端口 9090 访问，请使用以下命令运行 Jenkins：
   `java -jar jenkins.war --httpPort=9090`

- You can change the directory where Jenkins stores its configuration with the `JENKINS_HOME` environment variable. For example, to place the Jenkins configuration files in a subdirectory named `my-jenkins-config`, define `JENKINS_HOME=my-jenkins-config` before running the `java -jar jenkins.war` command. Use the Windows commands:
  您可以使用 `JENKINS_HOME` 环境变量更改 Jenkins 存储其配置的目录。例如，要将 Jenkins 配置文件放在名为 `my-jenkins-config` 的子目录中，请在运行 `java -jar jenkins.war` 命令之前定义 `JENKINS_HOME=my-jenkins-config` 。使用 Windows 命令：

  Windows 窗户

  ```
  C:\Temp > set JENKINS_HOME=my-jenkins-config
  C:\Temp > java -jar jenkins.war
  ```

or the Unix command: 或 Unix 命令：

Unix Unix的

```
JENKINS_HOME=my-jenkins-config java -jar jenkins.war
```

For more details of command line arguments that can adjust Jenkins startup, use the command:
有关可以调整 Jenkins 启动的命令行参数的更多详细信息，请使用以下命令：
 `java -jar jenkins.war --help`

## Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

### Unlocking Jenkins 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

### Customizing Jenkins with plugins 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/war-file/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/war-file/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

### Creating the first administrator user 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/war-file/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/war-file/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

# Other Servlet Containers 其他 Servlet 容器

Table of Contents 目录

- [Tomcat 9 Tomcat 9 系列](https://www.jenkins.io/doc/book/installing/servlet-containers/#tomcat-9)
- [WildFly 26 野生飞 26](https://www.jenkins.io/doc/book/installing/servlet-containers/#wildfly-26)

Jenkins is typically run as a standalone application in its own process. The Jenkins WAR file bundles [Winstone](https://github.com/jenkinsci/winstone), a [Jetty](https://www.eclipse.org/jetty/) servlet container wrapper, and can be started on any operating system or platform with a version of Java supported by Jenkins. This is the preferred way to deploy Jenkins and is fully supported.
Jenkins 通常作为其自身进程中的独立应用程序运行。Jenkins WAR 文件捆绑了 [Winstone](https://github.com/jenkinsci/winstone)（一种 [Jetty](https://www.eclipse.org/jetty/) servlet 容器包装器），可以在具有 Jenkins 支持的 Java 版本的任何操作系统或平台上启动。这是部署 Jenkins 的首选方式，并且完全受支持。

Theoretically, Jenkins can also be run as a servlet in a traditional servlet container like [Apache Tomcat](https://tomcat.apache.org/) or [WildFly](https://www.wildfly.org/), but in practice this is largely untested and there are many caveats. In particular, support for WebSocket agents is only implemented for the Jetty servlet container. See the [Servlet Container Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers) page for details.
从理论上讲，Jenkins 也可以在传统的 servlet 容器（如 [Apache Tomcat](https://tomcat.apache.org/) 或 [WildFly](https://www.wildfly.org/)）中作为 servlet 运行，但在实践中，这在很大程度上未经测试，并且存在许多注意事项。特别是，仅针对 Jetty servlet 容器实现对 WebSocket 代理的支持。有关详细信息，请参阅 [Servlet 容器支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers)页面。

|      | Support for traditional servlet containers may be discontinued in the future.  将来可能会停止对传统 servlet 容器的支持。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

Jenkins requires Servlet API 4.0 (Jakarta EE 8) with `javax.servlet` imports. Jenkins is incompatible with Servlet API 5.0 (Jakarta EE 9) or later with `jakarta.servlet` imports. Ensure that the Servlet API version of your chosen servlet container is compatible before running Jenkins.
Jenkins 需要 Servlet API 4.0 （Jakarta EE 8） 和 `javax.servlet` 导入。Jenkins 与 Servlet API 5.0 （Jakarta EE 9） 或更高版本不兼容，并且导入 `jakarta.servlet`。在运行 Jenkins 之前，请确保所选 servlet 容器的 Servlet API 版本兼容。

## Tomcat 9 Tomcat 9 系列

Tomcat 9 is based on Servlet API 4.0 (Jakarta EE 8), which is the version of the servlet API required by Jenkins.
Tomcat 9 基于 Servlet API 4.0 （Jakarta EE 8），这是 Jenkins 所需的 servlet API 版本。

|      | Later versions of Tomcat use newer versions of the Servlet API and are incompatible with Jenkins.  更高版本的 Tomcat 使用较新版本的 Servlet API，并且与 Jenkins 不兼容。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

Jenkins can be deployed to Tomcat by placing the Jenkins WAR file in the `${CATALINA_HOME}/webapps/` directory.
通过将 Jenkins WAR 文件放在 `${CATALINA_HOME}/webapps/` 目录中，可以将 Jenkins 部署到 Tomcat。

To configure the Jenkins home directory, set the `JENKINS_HOME` Java system property via the `CATALINA_OPTS` environment variable. For example, create `${CATALINA_HOME}/bin/setenv.sh` with the following contents:
要配置 Jenkins 主目录，请通过 `CATALINA_OPTS` 环境变量设置 `JENKINS_HOME` Java 系统属性。例如，使用以下内容创建 `${CATALINA_HOME}/bin/setenv.sh` ：

```
export CATALINA_OPTS=-DJENKINS_HOME=/var/lib/jenkins
```

|      | Running multiple Jenkins controllers within a single Java process is unsupported.  不支持在单个 Java 进程中运行多个 Jenkins 控制器。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

Scheme selection in redirect URLs is delegated to the servlet container, and Jetty handles the `X-Forwarded-For`, `X-Forwarded-By`, and `X-Forwarded-Proto` headers by default. With Tomcat, one needs to add a [Remote IP Valve](https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Remote_IP_Valve) to expose these headers to Jenkins via the Servlet API. Add the following to `${CATALINA_HOME}/conf/server.xml` within the `<Host>` section:
重定向 URL 中的方案选择委托给 servlet 容器，默认情况下，Jetty 会处理 `X-Forwarded-For`、`X-Forwarded-By` 和 `X-Forwarded-Proto` 标头。使用 Tomcat，需要添加一个[远程 IP Valve](https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html#Remote_IP_Valve)，以通过 Servlet API 将这些标头公开给 Jenkins。在 `<Host>` 部分中添加以下内容 `${CATALINA_HOME}/conf/server.xml` ：

```
<Valve className="org.apache.catalina.valves.RemoteIpValve"
       remoteIpHeader="X-Forwarded-For"
       proxiesHeader="X-Forwarded-By"
       protocolHeader="X-Forwarded-Proto" />
```

## WildFly 26 野生飞 26

WildFly 26 is based on Servlet API 4.0 (Jakarta EE 8), which is the version of the servlet API required by Jenkins.
WildFly 26 基于 Servlet API 4.0 （Jakarta EE 8），这是 Jenkins 所需的 Servlet API 版本。

|      | Later versions of WildFly use newer versions of the Servlet API and are incompatible with Jenkins.  更高版本的 WildFly 使用较新版本的 Servlet API，并且与 Jenkins 不兼容。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

Jenkins can be deployed to WildFly by placing the Jenkins WAR file in the `${JBOSS_HOME}/standalone/deployments/` directory.
通过将 Jenkins WAR 文件放在 `${JBOSS_HOME}/standalone/deployments/` 目录中，可以将 Jenkins 部署到 WildFly。

To configure the Jenkins home directory, set the `JENKINS_HOME` Java system property via the `JAVA_OPTS` environment variable. For example, update `${JBOSS_HOME}/bin/standalone.conf` with the following contents:
要配置 Jenkins 主目录，请通过 `JAVA_OPTS` 环境变量设置 `JENKINS_HOME` Java 系统属性。例如，使用以下内容进行更新 `${JBOSS_HOME}/bin/standalone.conf` ：

```
JAVA_OPTS="$JAVA_OPTS -DJENKINS_HOME=/var/lib/jenkins"
```

|      | Running multiple Jenkins controllers within a single Java process is unsupported.  不支持在单个 Java 进程中运行多个 Jenkins 控制器。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

# Offline Installations 脱机安装

Table of Contents 目录

- Prerequisites 先决条件
  - [Offline plugin installation
    离线插件安装](https://www.jenkins.io/doc/book/installing/offline/#offline-plugin-installation)
- Post-installation setup wizard
  安装后安装向导
  - [Unlocking Jenkins 解锁 Jenkins](https://www.jenkins.io/doc/book/installing/offline/#unlocking-jenkins)
  - [Customizing Jenkins with plugins
    使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/offline/#customizing-jenkins-with-plugins)
  - [Creating the first administrator user
    创建第一个管理员用户](https://www.jenkins.io/doc/book/installing/offline/#creating-the-first-administrator-user)

This section describes how to install Jenkins on a machine that does not have an internet connection.
本节介绍如何在没有 Internet 连接的计算机上安装 Jenkins。

To install Jenkins itself, download the appropriate war file and transfer it to your machine.
要安装 Jenkins 本身，请下载相应的 war 文件并将其传输到您的计算机上。

## Prerequisites 先决条件

Minimum hardware requirements:
最低硬件要求：

- 256 MB of RAM 256 MB 的内存
- 1 GB of drive space (although 10 GB is a recommended minimum if running Jenkins as a Docker container)
  1 GB 的驱动器空间（但如果将 Jenkins 作为 Docker 容器运行，建议至少为 10 GB）

Recommended hardware configuration for a small team:
小型团队的推荐硬件配置：

- 4 GB+ of RAM 4 GB+ 的 RAM
- 50 GB+ of drive space
  50 GB+ 的驱动器空间

Comprehensive hardware recommendations:
全面的硬件建议：

- Hardware: see the [Hardware Recommendations](https://www.jenkins.io/doc/book/scaling/hardware-recommendations) page
  硬件：请参阅[硬件建议](https://www.jenkins.io/doc/book/scaling/hardware-recommendations)页面

Software requirements: 软件要求：

- Java: see the [Java Requirements](https://www.jenkins.io/doc/book/platform-information/support-policy-java/) page
  Java：请参阅 [Java 要求](https://www.jenkins.io/doc/book/platform-information/support-policy-java/)页面
- Web browser: see the [Web Browser Compatibility](https://www.jenkins.io/doc/administration/requirements/web-browsers/) page
  Web 浏览器：请参阅 [Web 浏览器兼容性](https://www.jenkins.io/doc/administration/requirements/web-browsers/)页面
- For Windows operating system: [Windows Support Policy](https://www.jenkins.io/doc/administration/requirements/windows/)
  对于 Windows 操作系统：[Windows 支持策略](https://www.jenkins.io/doc/administration/requirements/windows/)
- For Linux operating system: [Linux Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
  对于 Linux 操作系统：[Linux 支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-linux/)
- For servlet containers: [Servlet Container Support Policy](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)
  对于 Servlet 容器：[Servlet 容器支持策略](https://www.jenkins.io/doc/book/platform-information/support-policy-servlet-containers/)

### Offline plugin installation 离线插件安装

Offline plugin installations require additional effort due to dependency requirements.
由于依赖项要求，离线插件安装需要额外的工作。

The [Plugin Installation Manager Tool](https://github.com/jenkinsci/plugin-installation-manager-tool) is the recommended tool for offline plugin installation. It downloads user specified plugins and all dependencies of the user specified plugins. The [Plugin Installation Manager Tool](https://github.com/jenkinsci/plugin-installation-manager-tool) also reports available plugin updates and plugin security warnings. It is included in the official [Jenkins Docker images](https://github.com/jenkinsci/docker/blob/master/README.md#plugin-installation-manager-cli-preview). It is also used to install plugins as part of the [Docker install instructions](https://www.jenkins.io/doc/book/installing/docker/). Refer to the [Gitter chat channel](https://app.gitter.im/#/room/#jenkinsci_plugin-installation-manager-cli-tool:gitter.im) for questions and answers
[Plugin Installation Manager Tool](https://github.com/jenkinsci/plugin-installation-manager-tool) 是推荐用于离线插件安装的工具。它下载用户指定的插件和用户指定插件的所有依赖项。[Plugin Installation Manager Tool](https://github.com/jenkinsci/plugin-installation-manager-tool) 还会报告可用的插件更新和插件安全警告。它包含在官方 [Jenkins Docker 镜像](https://github.com/jenkinsci/docker/blob/master/README.md#plugin-installation-manager-cli-preview)中。它还用于安装插件，作为 [Docker 安装说明](https://www.jenkins.io/doc/book/installing/docker/)的一部分。请参阅 [Gitter 聊天频道](https://app.gitter.im/#/room/#jenkinsci_plugin-installation-manager-cli-tool:gitter.im)，了解问题和解答

If you want to transfer the individual plugins, you’ll need to retrieve all dependencies as well. There are several dependency retrieval scripts and tools on Github. For example:
如果要传输单个插件，则还需要检索所有依赖项。Github 上有几个依赖项检索脚本和工具。例如：

- [Plugin installation manager tool](https://github.com/jenkinsci/plugin-installation-manager-tool/blob/master/README.md) - Java command line utility to install Jenkins plugins and their dependencies.
  [插件安装管理器工具](https://github.com/jenkinsci/plugin-installation-manager-tool/blob/master/README.md) - 用于安装 Jenkins 插件及其依赖项的 Java 命令行实用程序。
- [samrocketman/jenkins-bootstrap-shared](https://github.com/samrocketman/jenkins-bootstrap-shared) - Java is required; packages Jenkins and plugins into an immutable package installer.  Supported formats include: RPM, DEB, Docker. Can proxy Jenkins and plugins through Nexus or Artifactory since Gradle is used to assemble plugins.
  [samrocketman/jenkins-bootstrap-shared](https://github.com/samrocketman/jenkins-bootstrap-shared) - 需要 Java;将 Jenkins 和插件打包到一个不可变的软件包安装程序中。支持的格式包括：RPM、DEB、Docker。可以通过 Nexus 或 Artifactory 代理 Jenkins 和插件，因为 Gradle 用于组装插件。

## Post-installation setup wizard 安装后安装向导

After downloading, installing and running Jenkins using one of the procedures above (except for installation with Jenkins Operator), the post-installation setup wizard begins.
使用上述过程之一下载、安装和运行 Jenkins 后（使用 Jenkins 操作员进行安装除外），安装后设置向导将开始。

This setup wizard takes you through a few quick "one-off" steps to unlock Jenkins, customize it with plugins and create the first administrator user through which you can continue accessing Jenkins.
此设置向导将引导您完成一些快速的“一次性”步骤来解锁 Jenkins，使用插件对其进行自定义，并创建第一个管理员用户，您可以通过该用户继续访问 Jenkins。

### Unlocking Jenkins 解锁 Jenkins

When you first access a new Jenkins controller, you are asked to unlock it using an automatically-generated password.
当您首次访问新的 Jenkins 控制器时，系统会要求您使用自动生成的密码解锁它。

1. Browse to `http://localhost:8080` (or whichever port you configured for Jenkins when installing it) and wait until the **Unlock Jenkins** page appears.
   浏览到 `http://localhost:8080`（或您在安装 Jenkins 时为 Jenkins 配置的任何端口）并等待 **Unlock Jenkins （解锁 Jenkins**） 页面出现。

   ![Unlock Jenkins page](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg)

2. From the Jenkins console log output, copy the automatically-generated alphanumeric password (between the 2 sets of asterisks).
   从 Jenkins 控制台日志输出中，复制自动生成的字母数字密码（在 2 组星号之间）。

   ![Copying initial admin password](https://www.jenkins.io/doc/book/resources/tutorials/setup-jenkins-02-copying-initial-admin-password.png)
     **Note: 注意：**

   - The command: `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` will print the password at console.
     命令： `sudo cat /var/lib/jenkins/secrets/initialAdminPassword` 将在控制台打印密码。
   - If you are running Jenkins in Docker using the official `jenkins/jenkins` image you can use `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` to print the password in the console without having to exec into the container.
     如果您使用官方 `jenkins/jenkins` 镜像在 Docker 中运行 Jenkins，则可以使用 `sudo docker exec ${CONTAINER_ID or CONTAINER_NAME} cat /var/jenkins_home/secrets/initialAdminPassword` 它在控制台中打印密码，而无需执行到容器中。

3. On the **Unlock Jenkins** page, paste this password into the **Administrator password** field and click **Continue**.
   在 **Unlock Jenkins （解锁 Jenkins**） 页面上，将此密码粘贴到 **Administrator password （管理员密码**） 字段中，然后单击 **Continue （继续**）。
    **Note: 注意：**

   - The Jenkins console log indicates the location (in the Jenkins home directory) where this password can also be obtained. This password must be entered in the setup wizard on new Jenkins installations before you can access Jenkins’s main UI. This password also serves as the default administrator account’s password (with username "admin") if you happen to skip the subsequent user-creation step in the setup wizard.
     Jenkins 控制台日志指示也可以获取此密码的位置（在 Jenkins 主目录中）。必须先在新 Jenkins 安装的安装向导中输入此密码，然后才能访问  Jenkins 的主 UI。如果您碰巧跳过了设置向导中的后续用户创建步骤，则此密码还用作默认管理员帐户的密码（用户名为 “admin”）。

### Customizing Jenkins with plugins 使用插件自定义 Jenkins

After [unlocking Jenkins](https://www.jenkins.io/doc/book/installing/offline/#unlocking-jenkins), the **Customize Jenkins** page appears. Here you can install any number of useful plugins as part of your initial setup.
[解锁 Jenkins](https://www.jenkins.io/doc/book/installing/offline/#unlocking-jenkins) 后，将显示 **Customize Jenkins （自定义 Jenkins**） 页面。在这里，您可以安装任意数量的有用插件作为初始设置的一部分。

Click one of the two options shown:
单击显示的两个选项之一：

- **Install suggested plugins** - to install the recommended set of plugins, which are based on most common use cases.
  **安装建议的插件** - 安装建议的插件集，这些插件基于最常见的用例。
- **Select plugins to install** - to choose which set of plugins to initially install. When you first access the plugin selection page, the suggested plugins are selected by default.
  **选择要安装的插件** - 选择要初始安装的插件集。首次访问插件选择页面时，默认情况下会选择建议的插件。

|      | If you are not sure what plugins you need, choose **Install suggested plugins**. You can install (or remove) additional Jenkins plugins at a later point in time via the [**Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) page in Jenkins.  如果您不确定需要哪些插件，请选择 **Install recommended plugins（安装建议的插件**）。您可以在以后的某个时间点通过 [**Jenkins 中的 Manage Jenkins**](https://www.jenkins.io/doc/book/managing) > [**Plugins**](https://www.jenkins.io/doc/book/managing/plugins/) 页面安装（或删除）其他 Jenkins 插件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

The setup wizard shows the progression of Jenkins being configured and your chosen set of Jenkins plugins being installed. This process may take a few minutes.
设置向导显示正在配置 Jenkins 的进度以及您选择的 Jenkins 插件集正在安装。此过程可能需要几分钟时间。

### Creating the first administrator user 创建第一个管理员用户

Finally, after [customizing Jenkins with plugins](https://www.jenkins.io/doc/book/installing/offline/#customizing-jenkins-with-plugins), Jenkins asks you to create your first administrator user.
最后，[在使用插件自定义 Jenkins](https://www.jenkins.io/doc/book/installing/offline/#customizing-jenkins-with-plugins) 后，Jenkins 会要求您创建第一个管理员用户。

1. When the **Create First Admin User** page appears, specify the details for your administrator user in the respective fields and click **Save and Finish**.
   当 **Create First Admin User** 页面出现时，在相应字段中指定管理员用户的详细信息，然后单击 **Save and Finish**。
2. When the **Jenkins is ready** page appears, click **Start using Jenkins**.
   当 **Jenkins 准备就绪**页面出现时，单击 **Start using Jenkins**。
    **Notes: 笔记：**
   - This page may indicate **Jenkins is almost ready!** instead and if so, click **Restart**.
     此页面可能指示 **Jenkins 即将准备就绪！**如果是这样，请单击 **Restart**。
   - If the page does not automatically refresh after a minute, use your web browser to refresh the page manually.
     如果页面在一分钟后没有自动刷新，请使用 Web 浏览器手动刷新页面。
3. If required, log in to Jenkins with the credentials of the user you just created and you are ready to start using Jenkins!
   如果需要，请使用您刚刚创建的用户的凭证登录 Jenkins，然后您就可以开始使用 Jenkins 了！

------

# Initial Settings 初始设置

Table of Contents 目录

- Jenkins Parameters Jenkins 参数
  - [Networking parameters 组网参数](https://www.jenkins.io/doc/book/installing/initial-settings/#networking-parameters)
  - [Miscellaneous parameters 其他参数](https://www.jenkins.io/doc/book/installing/initial-settings/#miscellaneous-parameters)
  - [Jenkins properties Jenkins 属性](https://www.jenkins.io/doc/book/installing/initial-settings/#jenkins-properties)
- Configuring HTTP 配置 HTTP
  - [HTTPS with an existing certificate
    使用现有证书的 HTTPS](https://www.jenkins.io/doc/book/installing/initial-settings/#https-with-an-existing-certificate)
  - [Using HTTP/2 使用 HTTP/2](https://www.jenkins.io/doc/book/installing/initial-settings/#using-http2)
  - [HTTPS certificates with Windows
    Windows 的 HTTPS 证书](https://www.jenkins.io/doc/book/installing/initial-settings/#https-certificates-with-windows)

Most Jenkins configuration changes can be made through the Jenkins user interface or through the [configuration as code plugin](https://plugins.jenkins.io/configuration-as-code). There are some configuration values that can only be modified while Jenkins is starting. This section describes those settings and how you can use them.
大多数 Jenkins 配置更改可以通过 Jenkins 用户界面或[配置即代码插件](https://plugins.jenkins.io/configuration-as-code)进行。有些配置值只能在 Jenkins 启动时修改。本节介绍这些设置以及如何使用它们。

## Jenkins Parameters Jenkins 参数

Jenkins initialization can also be controlled by run time parameters passed as arguments. Command line arguments can adjust networking, security, monitoring, and other settings.
Jenkins 初始化也可以由作为参数传递的运行时参数来控制。命令行参数可以调整网络、安全、监控和其他设置。

### Networking parameters 组网参数

Jenkins networking configuration is generally controlled by command line arguments. The networking configuration arguments are:
Jenkins 网络配置通常由命令行参数控制。网络配置参数为：

| Command Line Parameter 命令行参数                   | Description 描述                                             |
| --------------------------------------------------- | ------------------------------------------------------------ |
| `--httpPort=$HTTP_PORT` `--httpPort=$HTTP_端口`     | Runs Jenkins listener on port $HTTP_PORT using standard *http* protocol. The default is port 8080. To disable (because you’re using *https*), use port `-1`. This option does not impact the root URL being generated within Jenkins logic (UI, inbound agent files, etc.). It is defined by the Jenkins URL specified in the global configuration. 使用标准 *http* 协议在端口 $HTTP_PORT 上运行 Jenkins 侦听器。默认值为 8080 端口。要禁用（因为您使用的是 *https*），请使用端口 `-1`。此选项不会影响在 Jenkins 逻辑（UI、入站代理文件等）中生成的根 URL。它由全局配置中指定的 Jenkins URL 定义。 |
| `--httpListenAddress=$HTTP_HOST`                    | Binds Jenkins to the IP address represented by $HTTP_HOST. The default is 0.0.0.0 — i.e. listening on all available interfaces. For example, to only listen for requests from localhost, you could use: `--httpListenAddress=127.0.0.1` 将 Jenkins 绑定到 $HTTP_HOST 表示的 IP 地址。默认值为 0.0.0.0 — 即监听所有可用接口。例如，要仅侦听来自 localhost 的请求，您可以使用：`--httpListenAddress=127.0.0.1` |
| `--httpsPort=$HTTPS_PORT` `--httpsPort=$HTTPS_端口` | Uses HTTPS protocol on port $HTTPS_PORT. This option does not impact the root URL being generated within Jenkins logic (UI, inbound agent files, etc.). It is defined by the Jenkins URL specified in the global configuration. 在端口 $HTTPS_PORT 上使用 HTTPS 协议。此选项不会影响在 Jenkins 逻辑（UI、入站代理文件等）中生成的根 URL。它由全局配置中指定的 Jenkins URL 定义。 |
| `--httpsListenAddress=$HTTPS_HOST`                  | Binds Jenkins to listen for HTTPS requests on the IP address represented by $HTTPS_HOST. 绑定 Jenkins 以侦听 $HTTPS_HOST 表示的 IP 地址上的 HTTPS 请求。 |
| `--http2Port=$HTTP_PORT`                            | Uses HTTP/2 protocol on port $HTTP_PORT. This option does not impact the root URL being generated within Jenkins logic (UI, inbound agent files, etc.). It is defined by the Jenkins URL specified in the global configuration. 在端口 $HTTP_PORT 上使用 HTTP/2 协议。此选项不会影响在 Jenkins 逻辑（UI、入站代理文件等）中生成的根 URL。它由全局配置中指定的 Jenkins URL 定义。 |
| `--http2ListenAddress=$HTTPS_HOST`                  | Binds Jenkins to listen for HTTP/2 requests on the IP address represented by $HTTPS_HOST. 绑定 Jenkins 以侦听 $HTTPS_HOST 表示的 IP 地址上的 HTTP/2 请求。 |
| `--prefix=$PREFIX` `--前缀=$PREFIX`                 | Runs Jenkins to include the $PREFIX at the end of the URL. For example, set *--prefix=/jenkins* to make Jenkins accessible at *http://myServer:8080/jenkins* 运行 Jenkins 以在 URL 末尾包含 $PREFIX。例如，设置 *--prefix=/jenkins* 以使 Jenkins 可在 *http://myServer:8080/jenkins* |
| `--sessionTimeout=$TIMEOUT`                         | Sets the http session timeout value to $SESSION_TIMEOUT minutes. Default to what webapp specifies, and then to 60 minutes 将 http 会话超时值设置为 $SESSION_TIMEOUT 分钟。默认为 webapp 指定的内容，然后是 60 分钟 |

### Miscellaneous parameters 其他参数

Other Jenkins initialization options are also controlled by command line arguments. The miscellaneous configuration arguments are:
其他 Jenkins 初始化选项也由命令行参数控制。其他配置参数包括：

| Command Line Parameter 命令行参数     | Description 描述                                             |
| ------------------------------------- | ------------------------------------------------------------ |
| `--argumentsRealm.passwd.$USER=$PASS` | Assigns the password for user $USER. If Jenkins security is enabled, you must log in as a user who has an *admin* role to configure Jenkins. 为用户分配密码 $USER。如果启用了 Jenkins 安全性，则必须以具有 *admin* 角色的用户身份登录才能配置 Jenkins。 |
| `--argumentsRealm.roles.$USER=admin`  | Assigns user $USER the admin  role. The user can configure Jenkins even if security is enabled in Jenkins. Refer to [Securing Jenkins](https://www.jenkins.io/doc/book/system-administration/security/) for more information. 将用户$USER admin 角色分配。即使在 Jenkins 中启用了安全性，用户也可以配置 Jenkins。有关更多信息，请参阅[保护 Jenkins](https://www.jenkins.io/doc/book/system-administration/security/)。 |
| `--paramsFromStdIn`                   | Reads parameters from standard input (stdin). When parameters are passed via the command line, they can be viewed using `ps(1)` in Unix or Process Explorer in Windows as long as the process keeps running. This is undesirable when passing sensitive parameters like `--httpsKeyStorePassword`. With the `--paramsFromStdIn` parameter you can replace e.g. 从标准输入 （stdin） 读取参数。 当参数通过命令行传递时，只要进程保持运行，就可以在 Unix 中使用 `ps（1）` 或在 Windows 中使用 Process Explorer 来查看它们。在传递敏感参数（如 `--httpsKeyStorePassword`）时，这是不可取的。使用 `--paramsFromStdIn` 参数，您可以替换例如：  `java -jar jenkins.war --httpPort=-1 --httpsPort=443 --httpsKeyStore=path/to/keystore --httpsKeyStorePassword=keystorePassword`  with 跟  `echo '--httpPort=-1 --httpsPort=443 --httpsKeyStore=path/to/keystore  --httpsKeyStorePassword=keystorePassword' | java -jar jenkins.war  --paramsFromStdIn`. |
| `--useJmx`                            | Enable [Jetty Java Management Extension (JMX)](https://www.eclipse.org/jetty/documentation/current/#jmx-chapter) 启用 [Jetty Java 管理扩展 （JMX）](https://www.eclipse.org/jetty/documentation/current/#jmx-chapter) |

Jenkins passes all command line parameters to the Winstone servlet container. More information about Jenkins Winstone command line parameters is available from the [Winstone Command Line Parameter Reference](https://github.com/jenkinsci/winstone#command-line-options).
Jenkins 将所有命令行参数传递给 Winstone servlet 容器。有关 Jenkins Winstone 命令行参数的更多信息，请参阅 [Winstone 命令行参数参考](https://github.com/jenkinsci/winstone#command-line-options)。

|      | **Be Careful with Command Line Parameters 小心使用命令行参数**  Jenkins ignores command line parameters it doesn’t understand instead of producing an error. Be careful when using command line parameters and make sure you have the correct spelling. For example, the parameter needed for defining the Jenkins administrative user is `--argument**s**Realm` and not `--argumentRealm`.  Jenkins 会忽略它不理解的命令行参数，而不会产生错误。 使用命令行参数时要小心，并确保拼写正确。 例如，定义 Jenkins 管理用户所需的参数是 `--argument**s**Realm`，而不是 `--argumentRealm`。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

### Jenkins properties Jenkins 属性

Some Jenkins behaviors are configured with Java properties. Java properties are set from the command line that started Jenkins. Property assignments use the form `-DsomeName=someValue` to assign the value `someValue` to the property named `someName`. For example, to assign the value `true` to a property `testName`, the command line argument would be `-DtestName=true`.
某些 Jenkins 行为是使用 Java 属性配置的。Java 属性是从启动 Jenkins 的命令行设置的。属性分配使用 `-DsomeName=someValue` 格式将值 `someValue` 分配给名为 `someName` 的属性。例如，要将值 `true` 分配给属性 `testName`，命令行参数将为 `-DtestName=true`。

Refer to the detailed list of [Jenkins properties](https://www.jenkins.io/doc/book/managing/system-properties/#Featurescontrolledbysystemproperties-PropertiesinJenkinsCore) for more information.
有关更多信息，请参阅 [Jenkins 属性](https://www.jenkins.io/doc/book/managing/system-properties/#Featurescontrolledbysystemproperties-PropertiesinJenkinsCore)的详细列表。

## Configuring HTTP 配置 HTTP

### HTTPS with an existing certificate 使用现有证书的 HTTPS

If you’re setting up Jenkins using the built-in Winstone server and want to use an existing certificate for HTTPS:
如果要使用内置的 Winstone 服务器设置 Jenkins，并希望将现有证书用于 HTTPS：

```
--httpPort=-1 \
--httpsPort=443 \
--httpsKeyStore=path/to/keystore \
--httpsKeyStorePassword=keystorePassword
```

### Using HTTP/2 使用 HTTP/2

The [HTTP/2 protocol](https://tools.ietf.org/html/rfc7540) allows web servers to reduce latency over encrypted connections by  pipelining requests, multiplexing requests, and allowing servers to  push, in some cases, before receiving a client request for the data. The Jetty server used by Jenkins supports HTTP/2 with the addition of  the Application-Layer Protocol Negotiation (ALPN) TLS extension.
[HTTP/2 协议](https://tools.ietf.org/html/rfc7540)允许 Web 服务器通过管道化请求、多路复用请求以及允许服务器在接收客户端数据请求之前推送来减少加密连接上的延迟。Jenkins 使用的 Jetty 服务器支持 HTTP/2，并添加了应用层协议协商 （ALPN） TLS 扩展。

|      | Enabling HTTP/2 implicitly enables TLS even if no HTTPS port is set, and as of Jenkins 2.339, which uses Winstone 5.23, you have to also specify an HTTPS key store file.  即使未设置 HTTPS 端口，启用 HTTP/2 也会隐式启用 TLS，并且从使用 Winstone 5.23 的 Jenkins 2.339 开始，您还必须指定 HTTPS 密钥存储文件。 |
| ---- | ------------------------------------------------------------ |
|      |                                                              |

```
--httpPort=-1 \
--http2Port=9090 \
--httpsKeyStore=path/to/keystore \
--httpsKeyStorePassword=keystorePassword
```

### HTTPS certificates with Windows Windows 的 HTTPS 证书

These instructions use a stock Jenkins installation on Windows Server. The instructions assume a certificate signed by a Certificate Authority such as Digicert. If you are making your own certificate skip steps 3, 4, and 5.
这些说明使用 Windows Server 上的库存 Jenkins 安装。这些说明假定证书由证书颁发机构（如 Digicert）签名。如果要制作自己的证书，请跳过步骤 3、4 和 5。

This process utilizes Java’s keytool. Use the Java `keytool` included with your Java installation.
此过程利用 Java 的 keytool。使用 Java 安装中包含的 Java `keytool`。

**Step 1**: Create a new keystore on your server. This will place a 'keystore' file in your current directory.
**第 1 步**：在您的服务器上创建一个新的密钥库。这会将 'keystore' 文件放置在您的当前目录中。

```
C:\>keytool -genkeypair -keysize 2048 -keyalg RSA -alias jenkins -keystore keystore
Enter keystore password:
Re-enter new password:
What is your first and last name?
[Unknown]: server.example.com
What is the name of your organizational unit?
[Unknown]: A Unit
What is the name of your organization?
[Unknown]: A Company
What is the name of your City or Locality?
[Unknown]: A City
What is the name of your State or Province?
[Unknown]: A State
What is the two-letter country code for this unit?
[Unknown]: US
Is CN=server.example.com, OU=A Unit, O=A Company, L=A City, ST=A State, C=US correct?
[no]: yes

Enter key password for <jenkins>
(RETURN if same as keystore password):
```

**Step 2**: Verify the keystore was created (your fingerprint will vary).
**第 2 步**：验证是否已创建密钥库（您的指纹会有所不同）。

```
C:\>keytool -list -keystore keystore
Enter keystore password:

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 1 entry

jenkins, May 6, 2015, PrivateKeyEntry,
Certificate fingerprint (SHA1): AA:AA:AA:AA:AA:AA:AA:AA:AA:AA ...
```

**Step 3**: Create the certificate request.  This will create a 'certreq.csr' file in your current directory.
**步骤 3**：创建证书请求。这将在当前目录中创建一个 'certreq.csr' 文件。

```
C:\>keytool -certreq -alias jenkins -keyalg RSA ^
-file certreq.csr ^
-ext SAN=dns:server-name,dns:server-name.your.company.com ^
-keystore keystore
Enter keystore password:
```

**Step 4**: Use the contents of the `certreq.csr` file to generate a certificate from your certificate provider. Request a SHA-1 certificate (SHA-2 is untested but will likely work). If using DigiCert, download the resulting certificate as Other format  "a .p7b bundle of all the certs in a .p7b file".
**步骤 4**：使用 `certreq.csr` 文件的内容从证书提供商生成证书。申请 SHA-1 证书（SHA-2 未经测试，但可能会有效）。如果使用 DigiCert，请将生成的证书下载为“其他格式”a .p7b bundle of all the certs in a .p7b file”。

**Step 5**: Add the resulting .p7b into the keystore you created above.
**第 5 步**：将生成的 .p7b 添加到您上面创建的密钥库中。

```
C:\>keytool -import ^
-alias jenkins ^
-trustcacerts ^
-file response_from_digicert.p7b ^
-keystore keystore
Enter keystore password:
Certificate reply was installed in keystore
```

**Step 6**: Copy the 'keystore' file to your Jenkins secrets directory. On a stock installation, this will be at
**第 6 步**：将 'keystore' 文件复制到您的 Jenkins 密钥目录。在 Stock 安装中，这将位于

```
C:\Program Files (x86)\Jenkins\secrets
```

**Step 7**: Modify the <arguments> section of your `C:\Program Files (x86)\Jenkins\jenkins.xml` file to reflect the new certificate. NOTE: This example disables http via `--httpPort=-1` and places the server on `8443` via `--httpsPort=8443`.
**第 7 步**：修改 `C:\Program Files (x86)\Jenkins\jenkins.xml` 文件部分以反映新证书。注意：此示例通过 `--httpPort=-1` 禁用 http，并通过 `--httpsPort=8443` 将服务器放置在 `8443` 上。

```
<arguments>
  -Xrs
  -Xmx256m
  -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle
  -jar "%BASE%\jenkins.war"
  --httpPort=-1
  --httpsPort=8443
  --httpsKeyStore="%BASE%\secrets\keystore"
  --httpsKeyStorePassword=your.password.here
</arguments>
```

**Step 8**: Restart the jenkins service to initialize the new configuration.
**第 8 步**：重新启动 jenkins 服务以初始化新配置。

```
net stop jenkins
net start jenkins
```

**Step 9**: After 30-60 seconds, Jenkins will have completed the startup process and you should be able to access the website at *https://server.example.com:8443*. Verify the certificate looks good via your browser’s tools. If the service terminates immediately, there’s an error somewhere in your configuration. Useful error information can be found in:
**第 9 步**：30-60 秒后，Jenkins 将完成启动过程，您应该能够 *https://server.example.com:8443* 访问该网站。通过浏览器的工具验证证书是否正常。如果服务立即终止，则您的配置中某处存在错误。有用的错误信息可以在以下位置找到：

```
C:\Program Files (x86)\Jenkins\jenkins.err.log
C:\Program Files (x86)\Jenkins\jenkins.out.log
```