# Rocky Linux â€”â€” ç½‘ç»œé…ç½®[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#rocky-linux)

#  Network[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#implementing-the-network)

In this chapter you will learn how to work with and manage the network.

------

**ç›®æ ‡** : æœ¬ç« å°†è®²è§£ä»¥ä¸‹å†…å®¹ï¼š

![âœ”](https://twemoji.maxcdn.com/v/latest/svg/2714.svg) Configure a workstation to use DHCP;
 ![âœ”](https://twemoji.maxcdn.com/v/latest/svg/2714.svg) Configure a workstation to use a static configuration; 
 ![âœ”](https://twemoji.maxcdn.com/v/latest/svg/2714.svg) Configure a workstation to use a gateway; 
 ![âœ”](https://twemoji.maxcdn.com/v/latest/svg/2714.svg) Configure a workstation to use DNS servers; 
 ![âœ”](https://twemoji.maxcdn.com/v/latest/svg/2714.svg) Troubleshoot the network of a workstation.

![ğŸ](https://twemoji.maxcdn.com/v/latest/svg/1f3c1.svg) **network**, **linux**, **ip**

**Knowledge**: ![â­](https://twemoji.maxcdn.com/v/latest/svg/2b50.svg) ![â­](https://twemoji.maxcdn.com/v/latest/svg/2b50.svg)
 **Complexity**: ![â­](https://twemoji.maxcdn.com/v/latest/svg/2b50.svg) ![â­](https://twemoji.maxcdn.com/v/latest/svg/2b50.svg)

**é˜…è¯»æ—¶é—´**: 30 åˆ†é’Ÿ

------

## æ¦‚è®º[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#_1)

To illustrate this chapter, we will use the following architecture.

![Illustration of our network architecture](https://docs.rockylinux.org/books/admin_guide/images/network-001.png)

It will allow us to consider :

- integration in a LAN (local area network);
- the configuration of a gateway to reach a remote server;
- the configuration of a DNS server and the implementation of name resolution.

The minimum parameters to be defined for the machine are:

- the name of the machine ;
- the IP address;
- the subnet mask.

Example:

- `pc-rocky`;
- `192.168.1.10`;
- `255.255.255.0`.

The notation called CIDR is more and more frequent: 192.168.1.10/24

IP addresses are used for the proper routing of messages (packets). They are divided into two parts:

- the fixed part, identifying the network;
- the identifier of the host in the network.

The subnet mask is a set of **4 bytes** intended to isolate:

- the network address (**NetID** or **SubnetID**) by performing a bitwise logical AND between the IP address and the mask;
- the host address (**HostID**) by performing a bitwise logical AND between the IP address and the complement of the mask.

There are also specific addresses within a network, which must be  identified. The first address of a range as well as the last one have a  particular role:

- The first address of a range is the **network address**. It is used to identify networks and to route information from one network to another.
- The last address of a range is the **broadcast address**. It is used to broadcast information to all the machines on the network.

### MAC address / IP address[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#mac-address-ip-address)

A **MAC address** is a physical identifier written in  the factory onto the device. This is sometimes referred to as the  hardware address. It consists of 6 bytes often given in hexadecimal form (for example 5E:FF:56:A2:AF:15). It is composed of : 3 bytes of the  manufacturer identifier and 3 bytes of the serial number.

!!! Warning This last statement is nowadays a little less true with  virtualization. There are also software solutions for changing the MAC  address.

An Internet Protocol (**IP**) address is an  identification number permanently or temporarily assigned to each device connected to a computer network using the Internet Protocol. One part  defines the network address (NetID or SubnetID as the case may be), the  other part defines the address of the host in the network (HostID). The  relative size of each part varies according to the network (sub)mask.

An IPv4 address defines an address on 4 bytes. The number of  available addresses being close to saturation a new standard was  created, the IPv6 defined on 16 bytes.

IPv6 is often represented by 8 groups of 2 bytes separated by a  colon. Insignificant zeros can be omitted, one or more groups of 4  consecutive zeros can be replaced by a double colon.

Subnet masks have from 0 to 128 bits. (for example 21ac:0000:0000:0611:21e0:00ba:321b:54da/64 or 21ac::611:21e0![ğŸ‡§ğŸ‡¦](https://twemoji.maxcdn.com/v/latest/svg/1f1e7-1f1e6.svg)321b:54da/64)

In a web address or URL (Uniform Resource Locator), an ip address can be followed by a colon and the port address (which indicates the  application to which the data is destined). Also to avoid confusion in a URL, the IPv6 address is written in square brackets [ ], colon, port  address.

IP and MAC addresses must be unique on a network!

### DNS Domain[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#dns-domain)

Client machines can be part of a DNS (**Domain Name System**, e.g. `mydomain.lan`) domain.

The fully qualified machine name (**FQDN**) becomes `pc-rocky.mydomain.lan`.

A set of computers can be grouped into a logical, name-resolving, set called a DNS domain. A DNS domain is not, of course, limited to a  single physical network.

In order for a computer to be part of a DNS domain, it must be given a DNS suffix (here `mydomain.lan`) as well as servers that it can query.

### Reminder of the OSI model[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#reminder-of-the-osi-model)

!!! Note "Memory aid" To remember the order of the layers of the OSI model, remember the following sentence: **Please Do Not Touch Steven's Pet Alligator**.

| Layer            | Protocoles                                 |
| ---------------- | ------------------------------------------ |
| 7 - Application  | POP, IMAP, SMTP, SSH, SNMP, HTTP, FTP, ... |
| 6 - Presentation | ASCII, MIME, ...                           |
| 5 - Session      | TLS, SSL, NetBIOS, ...                     |
| 4 - Transport    | TLS, SSL, TCP, UDP, ...                    |
| 3 - Network      | IPv4, IPv6, ARP, ...                       |
| 2 - Data Link    | Ethernet, WiFi, Token Ring, ...            |
| 1 - Physical     | Cables, optical fibers, radio waves, ...   |

**Layer 1** (Physical) supports transmission over a communication channel (Wifi, Optical fiber, RJ cable, etc.). Unit: the bit.

**Layer 2** (Data Link) supports network topology (token-ring, star, bus, etc.), data splitting and transmission errors. Unit: the frame.

**Layer 3** (Network) supports end-to-end data transmission (IP routing = Gateway). Unit: the packet.

**Layer 4** (Transport) supports service type (connected or unconnected) encryption and flow control. Unit: the segment or the datagram.

**Layer 5** (Session) supports the communication between two computers.

**Layer 6** (Presentation) represents the area that is  independent of data at the application layer. Essentially this layer  translates from network format to the application format, or or from the application format to the network format.

**Layer 7** (Application) represents the contact with  the user. It provides the services offered by the network: http, dns,  ftp, imap, pop, smtp, etc.

## The naming of interfaces[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#the-naming-of-interfaces)

*lo* is the "**loopback**" interface which allows TCP/IP programs to communicate with each other without leaving the  local machine. This enables testing if the **network module of the system is working properly** and also allows pinging the localhost. All packets that enter through  localhost leave through localhost. The packets received are the packets  sent.

The Linux kernel assigns interface names with a specific prefix depending on the type. Traditionally, all **Ethernet** interfaces, for example, began with **eth**. The prefix was followed by a number, the first being 0 (eth0, eth1, eth2...). The wifi interfaces were given a wlan prefix.

On Rocky8 Linux distributions, systemd will name interfaces with the new following policy where "X" represents a number:

- `enoX`:  on-board devices
- `ensX`: PCI Express hotplug slot
- `enpXsX`: physical/geographical location of the connector of the hardware
- ...

## Using the `ip` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#using-the-ip-command)

Forget the old `ifconfig` command! Think `ip`!

!!! Note Comment for administrators of older Linux systems:

```
The historical network management command is `ifconfig`. This command has been replaced by the `ip` command, which is already well known to network administrators.

The `ip` command is the only command to manage **IP address, ARP, routing, etc.**.

The `ifconfig` command is no longer installed by default in Rocky8.

It is important to get into good habits now.
```

## The hostname[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#the-hostname)

The `hostname` command displays or sets the host name of the system

```
hostname [-f] [hostname]
```

| Option | Description                    |
| ------ | ------------------------------ |
| `-f`   | Display the FQDN               |
| `-i`   | Display the system IPs address |

!!! Tip This command is used by various network programs to identify the machine.

To assign a host name, it is possible to use the `hostname` command, but the changes will not be retained at the next boot. The command with no arguments displays the host name.

To set the host name, the file `/etc/sysconfig/network` must be modified:

```
NETWORKING=yes
HOSTNAME=pc-rocky.mondomaine.lan
```

The RedHat boot script also consults the `/etc/hosts` file to resolve the host name of the system.

When the system boots, Linux evaluates the `HOSTNAME` value in the `/etc/sysconfig/network` file.

It then uses the `/etc/hosts` file to evaluate the main IP address of the server and its host name. It deduces the DNS domain name.

It is therefore essential to fill in these two files before any configuration of network services.

!!! Tip To know if this configuration is well done, the commands `hostname` and `hostname -f` must answer with the expected values.

## /etc/hosts file[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#etchosts-file)

The `/etc/hosts` file is a static host name mapping table, which follows the following format:

```
@IP <hostname>  [alias]  [# comment]
```

Example of `/etc/hosts` file:

```
127.0.0.1   localhost localhost.localdomain
::1         localhost localhost.localdomain
192.168.1.10    rockstar.rockylinux.lan rockstar
```

The `/etc/hosts` file is still used by the system, especially at boot time when the system FQDN is determined.

!!! Tip RedHat recommends that at least one line containing the system name be filled in.

If the **DNS** service (**D**domain **N**ame **S**ervice) is not in place, you must fill in all the names in the hosts file for each of your machines.

The `/etc/hosts` file contains one line per entry, with  the IP address, the FQDN, then the host name (in that order) and a  series of aliases (alias1 alias2 ...). The alias is an option.

## `/etc/nsswitch.conf` file[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#etcnsswitchconf-file)

The **NSS** (**N**ame **S**ervice **S**witch) allows configuration files (e.g. `/etc/passwd`, `/etc/group`, `/etc/hosts`) to be substituted for one or more centralized databases.

The `/etc/nsswitch.conf` file is used to configure the name service databases.

```
passwd: files
shadow: files
group: files

hosts: files dns
```

In this case, Linux will first look for a host name match (`hosts:` line) in the `/etc/hosts` file (`files` value) before querying DNS (`dns` value)! This behavior can simply be changed by editing the `/etc/nsswitch.conf` file.

Of course, it is possible to imagine querying an LDAP, MySQL or other server by configuring the name service to respond to system requests  for hosts, users, groups, etc.

The resolution of the name service can be tested with the `getent` command that we will see later in this course.

## `/etc/resolv.conf` file[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#etcresolvconf-file)

The `/etc/resolv.conf` file contains the DNS name resolution configuration.

```
#Generated by NetworkManager
domain mondomaine.lan
search mondomaine.lan
nameserver 192.168.1.254
```

!!! Tip This file is historical. It is no longer filled in directly!

Newer generations of distributions have generally integrated the `NetworkManager` service. This service allows you to manage the configuration more efficiently, either in graphical or console mode.

It allows for the addition of DNS servers from the configuration file of a network interface. It then dynamically populates the `/etc/resolv.conf` file which should never be edited directly, otherwise the configuration changes will be lost the next time the network service is started.

## `ip` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#ip-command)

The `ip` command from the `iproute2` package allows you to configure an interface and its routing table.

Display interfaces :

```
[root]# ip link
```

Display interfaces information:

```
[root]# ip addr show
```

Display the information of an interface :

```
[root]# ip addr show eth0
```

Display the ARP table:

```
[root]# ip neigh
```

All historical network management commands have been grouped under the `ip` command, which is well known to network administrators.

## DHCP configuration[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#dhcp-configuration)

The **DHCP** protocol (**D**ynamic **H**ost **C**Control **P**rotocol) allows you to obtain a complete IP configuration via the network. This  is the default configuration mode of a network interface under Rocky  Linux, which explains why a system connected to the network of an  Internet router can function without additional configuration.

The configuration of interfaces under Rocky Linux is done in the `/etc/sysconfig/network-scripts/` folder.

For each Ethernet interface, a `ifcfg-ethX` file allows for the configuration of the associated interface.

```
DEVICE=eth0
ONBOOT=yes
BOOTPROTO=dhcp
HWADDR=00:0c:29:96:32:e3
```

- Interface name : (must be in the file name)

```
DEVICE=eth0
```

- Automatically start the interface:

```
ONBOOT=yes
```

- Make a DHCP request when the interface starts up:

```
BOOTPROTO=dhcp
```

- Specify the MAC address (optional but useful when there are several interfaces) :

```
HWADDR=00:0c:29:96:32:e3
```

!!! Tip If NetworkManager is installed, the changes are taken into  account automatically. If not, you have to restart the network service.

- Restart the network service:

```
[root]# systemctl restart NetworkManager
```

## Static configuration[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#static-configuration)

The static configuration requires at least:

```
DEVICE=eth0
ONBOOT=yes
BOOTPROTO=none
IPADDR=192.168.1.10
NETMASK=255.255.255.0
```

- Here we are replacing "dhcp" with "none" which equals static configuration:

```
BOOTPROTO=none
```

- IP Address:

```
IPADDR=192.168.1.10
```

- Subnet mask:

```
NETMASK=255.255.255.0
```

- The mask can be specified with a prefix:

```
PREFIX=24
```

!!! Warning You must use NETMASK OR PREFIX - Not both!

## Routing[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#routing)

![Network architecture with a gateway](https://docs.rockylinux.org/books/admin_guide/images/network-002.png)

```
DEVICE=eth0
ONBOOT=yes
BOOTPROTO=none
HWADDR=00:0c:29:96:32:e3
IPADDR=192.168.1.10
NETMASK=255.255.255.0
GATEWAY=192.168.1.254
```

The `ip route` command:

```
[root]# ip route show
192.168.1.0/24 dev eth0 [â€¦] src 192.168.1.10 metric 1
default via 192.168.1.254 dev eth0 proto static
```

It is a good idea to know how to read a routing table, especially in an environment with multiple network interfaces.

- In the example shown, the `192.168.1.0/24` network is reachable directly from the `eth0` device, so there is a metric at `1` (does not traverse a router).
- All other networks than the previous one will be reachable, again from the `eth0` device, but this time the packets will be addressed to a `192.168.1.254` gateway. The routing protocol is a static protocol (although it is  possible to add a route to a dynamically assigned address in Linux).

## Name resolution[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#name-resolution)

A system needs to resolve:

- FQDNs into IP addresses

```
www.free.fr = 212.27.48.10
```

- IP addresses into names

```
212.27.48.10 = www.free.fr
```

- or to obtain information about an area:

```
MX de free.fr = 10 mx1.free.fr + 20 mx2.free.fr
DEVICE=eth0
ONBOOT=yes
BOOTPROTO=none
HWADDR=00:0c:29:96:32:e3
IPADDR=192.168.1.10
NETMASK=255.255.255.0
GATEWAY=192.168.1.254
DNS1=172.16.1.2
DNS2=172.16.1.3
DOMAIN=rockylinux.lan
```

In this case, to reach the DNS, you have to go through the gateway.

```
 #Generated by NetworkManager
 domain mondomaine.lan
 search mondomaine.lan
 nameserver 172.16.1.2
 nameserver 172.16.1.3
```

The file has been updated by NetworkManager.

## Troubleshooting[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#troubleshooting)

The `ping` command sends datagrams to another machine and waits for a response.

It is the basic command for testing the network because it checks the connectivity between your network interface and another.

Syntax of the `ping` command:

```
ping [-c numerical] destination
```

The `-c` (count) option allows you to stop the command after the countdown in seconds.

Example:

```
[root]# ping â€“c 4 localhost
```

Tip

\1) Validate the TCP/IP software layer

```
[root]# ping localhost
```

"Pinging" the inner loop does not detect a hardware failure on the  network interface. It simply determines whether the IP software  configuration is correct.

\2) Validate the network card

```
[root]# ping 192.168.1.10
```

To determine that the network card is functional, we must now ping  its IP address. The network card, if the network cable is not connected, should be in a "down" state.

If the ping does not work, first check the network cable to your network switch and reassemble the interface (see the `if up` command), then check the interface itself.

\3) Validate the connectivity of the gateway

```
[root]# ping 192.168.1.254
```

\4) Validate the connectivity of a remote server

```
[root]# ping 172.16.1.2
```

\5) Validate the DNS service

```
[root]# ping www.free.fr
```

### `dig` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#dig-command)

The `dig` command is used to query the DNS server.

The `dig` command syntax:

```
dig [-t type] [+short] [name]
```

Examples:

```
[root]# dig +short rockylinux.org
76.223.126.88
[root]# dig -t MX +short rockylinux.org                                                         î‚² âœ”
5 alt1.aspmx.l.google.com.
...
```

The `dig` command is used to query DNS servers. It is very verbose by default, but this behavior can be changed with the `+short` option.

It is also possible to specify a DNS **record type** to resolve, such as an MX **type** to get information about the mail exchangers for a domain.

### `getent` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#getent-command)

The `getent` (get entry) command is used to get an NSSwitch entry (`hosts` + `dns`)

Syntax of the `getent` command:

```
getent hosts name
```

Example:

```
[root]# getent hosts rockylinux.org
  76.223.126.88 rockylinux.org
```

Querying only a DNS server may return an erroneous result that does not take into account the contents of a `hosts` file, although this should be rare nowadays.

To take the `/etc/hosts` file into account as well, the NSSwitch name service must be queried, which will take care of any DNS resolution.

### `ipcalc` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#ipcalc-command)

The `ipcalc` (**ip calculation**) command is used to calculate the address of a network or broadcast from an IP address and a mask.

Syntax of the `ipcalc` command:

```
ipcalc  [options] IP <netmask>
```

Example:

```
[root]# ipcalc â€“b 172.16.66.203 255.255.240.0
BROADCAST=172.16.79.255
```

!!! Tip This command is interesting followed by a redirection to  automatically fill in the configuration files of your interfaces:

````
```
[root]# ipcalc â€“b 172.16.66.203 255.255.240.0 >> /etc/sysconfig/network-scripts/ifcfg-eth0
```
````

| Option | Description                            |
| ------ | -------------------------------------- |
| `-b`   | Displays the broadcast address.        |
| `-n`   | Displays the network address and mask. |

`ipcalc` is a simple way to calculate the IP information of a host. The various options indicate what information `ipcalc` should display on the standard output. Multiple options can be  specified. An IP address on which to operate must be specified. Most  operations also require a network mask or CIDR prefix.

| Option short | Option long   | Description                                                  |
| ------------ | ------------- | ------------------------------------------------------------ |
| `-b`         | `--broadcast` | Displays the broadcast address of the given IP address and the network mask. |
| `-h`         | `--hostname`  | Displays the hostname of the IP address given via DNS.       |
| `-n`         | `--netmask`   | Calculates the network mask for the given IP address. Assumes that  the IP address is part of a complete class A, B, or C network. Many  networks do not use default network masks, in which case an incorrect  incorrect value will be returned. |
| `-p`         | `--prefix`    | Indicates the prefix of the mask/IP address.                 |
| `-n`         | `--network`   | Indicates the network address of the given IP address and mask. |
| `-s`         | `--silent`    | Never displays any error messages.                           |

### `ss` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#ss-command)

The `ss` (**socket statistics**) command displays the listening ports on the network.

Syntax of the `ss` command:

```
ss [-tuna]
```

Example:

```
[root]# ss â€“tuna
tcp   LISTEN   0   128   *:22   *:*
```

The commands `ss` and `netstat` (to follow) will be very important for the rest of your Linux life.

When implementing network services, it is very common to check with  one of these two commands that the service is listening on the expected  ports.

### `netstat` command[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#netstat-command)

!!! Warning The `netstat` command is now deprecated and is no-longer installed by default on Rocky Linux. You may still find some  Linux versions that have it installed, but it is best to move on to  using `ss` for everything that you would have used `netstat` for.

The `netstat` command (**network statistics**) displays the listening ports on the network.

Syntax of the `netstat` command:

```
netstat -tapn
```

Example:

```
[root]# netstat â€“tapn
tcp  0  0  0.0.0.0:22  0.0.0.0:*  LISTEN 2161/sshd
```

### IP or MAC address conflicts[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#ip-or-mac-address-conflicts)

A misconfiguration can cause multiple interfaces to use the same IP  address. This can happen when a network has multiple DHCP servers or  when the same IP address is manually assigned multiple times.

When the network is malfunctioning, and when an IP address conflict could be the cause, it is possible to use the `arp-scan` software (requires the EPEL repository):

```
$ dnf install arp-scan
```

Example:

```
$ arp-scan -I eth0 -l

172.16.1.104  00:01:02:03:04:05       3COM CORPORATION
172.16.1.107  00:0c:29:1b:eb:97       VMware, Inc.
172.16.1.250  00:26:ab:b1:b7:f6       (Unknown)
172.16.1.252  00:50:56:a9:6a:ed       VMWare, Inc.
172.16.1.253  00:50:56:b6:78:ec       VMWare, Inc.
172.16.1.253  00:50:56:b6:78:ec       VMWare, Inc. (DUP: 2)
172.16.1.253  00:50:56:b6:78:ec       VMWare, Inc. (DUP: 3)
172.16.1.253  00:50:56:b6:78:ec       VMWare, Inc. (DUP: 4)
172.16.1.232   88:51:fb:5e:fa:b3       (Unknown) (DUP: 2)
```

!!! Tip As the above example shows, it is also possible to have MAC  address conflicts! These problems are brought about by virtualization  technologies and the copying of virtual machines.

## Hot configuration[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#hot-configuration)

The `ip` command can hot add an IP address to an interface

```
ip addr add @IP dev DEVICE
```

Example:

```
[root]# ip addr add 192.168.2.10 dev eth1
```

The `ip` command allows for the activation or deactivation of an interface:

```
ip link set DEVICE up
ip link set DEVICE down
```

Example:

```
[root]# ip link set eth1 up
[root]# ip link set eth1 down
```

The `ip` command is used to add a route:

```
ip route add [default|netaddr] via @IP [dev device]
```

Example:

```
[root]# ip route add default via 192.168.1.254
[root]# ip route add 192.168.100.0/24 via 192.168.2.254 dev eth1
```

## In summary[Â¶](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#in-summary)

The files used in this chapter are :

![Synthesis of the files implemented in the network part](https://docs.rockylinux.org/books/admin_guide/images/network-003.png)

A complete interface configuration could be this (file `/etc/sysconfig/network-scripts/ifcfg-eth0`):

```
 DEVICE=eth0
 ONBOOT=yes
 BOOTPROTO=none
 HWADDR=00:0c:29:96:32:e3
 IPADDR=192.168.1.10
 NETMASK=255.255.255.0
 GATEWAY=192.168.1.254
 DNS1=172.16.1.1
 DNS2=172.16.1.2
 DOMAIN=rockylinux.lan
```

The troubleshooting method should go from closest to farthest:

1. ping localhost (software test)
2. ping IP-address (hardware test)
3. ping gateway (connectivity test)
4. ping remote-server (routing test)
5. DNS query (dig or ping)

![Method of troubleshooting or network validation](https://docs.rockylinux.org/books/admin_guide/images/network-004.png)

[             ](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#)

[             å›åˆ°é¡µé¢é¡¶éƒ¨           ](https://docs.rockylinux.org/zh/books/admin_guide/12-network/#)              

[                                   ](https://docs.rockylinux.org/zh/books/admin_guide/11-tasks/)

[                                             ä¸Šä¸€é¡µ                              Task Management                                 ](https://docs.rockylinux.org/zh/books/admin_guide/11-tasks/)[                                                        ä¸‹ä¸€é¡µ                              ](https://docs.rockylinux.org/zh/books/admin_guide/13-softwares/)

## å‡†å¤‡å·¥ä½œ[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_1)

- ç†Ÿæ‚‰å‘½ä»¤è¡Œæ“ä½œ
- æå‡æˆ–ç®¡ç†ç³»ç»Ÿæƒé™ï¼ˆä¾‹å¦‚rootã€sudoç­‰ï¼‰
- å¯é€‰ï¼šç†Ÿæ‚‰ç½‘ç»œæ¦‚å¿µ

# ç®€ä»‹[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_2)

å¦‚ä»Šï¼Œä¸€å°æ²¡æœ‰ç½‘ç»œè¿æ¥çš„è®¡ç®—æœºå‡ ä¹æ¯«æ— ç”¨å¤„ã€‚æ— è®ºæ‚¨æ˜¯éœ€è¦æ›´æ–°æœåŠ¡å™¨ä¸Šçš„è½¯ä»¶åŒ…ï¼Œè¿˜æ˜¯åªéœ€ä»ç¬”è®°æœ¬ç”µè„‘æµè§ˆå¤–éƒ¨ç½‘ç«™ï¼Œæ‚¨éƒ½éœ€è¦ç½‘ç»œè®¿é—®ï¼

æœ¬æ–‡æ—¨åœ¨ä¸º RockyLinux ç”¨æˆ·æä¾›å¦‚ä½•åœ¨ Rocky Linux ç³»ç»Ÿä¸Šè®¾ç½®ç½‘ç»œè¿æ¥çš„åŸºæœ¬çŸ¥è¯†ã€‚

## ä½¿ç”¨ NetworkManager æœåŠ¡[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#networkmanager)

åœ¨ç”¨æˆ·çº§åˆ«ï¼Œç½‘ç»œå †æ ˆç”± *NetworkManager* ç®¡ç†ã€‚è¯¥å·¥å…·ä½œä¸ºæœåŠ¡è¿è¡Œï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥å…¶çŠ¶æ€ï¼š

```
systemctl status NetworkManager
```

### é…ç½®æ–‡ä»¶[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_3)

NetworkManager åªåº”ç”¨ä» `/etc/sysconfig/network-scripts/ifcfg-<IFACE_NAME>` æ–‡ä»¶ä¸­è¯»å–çš„é…ç½®ã€‚ æ¯ä¸ªç½‘ç»œæ¥å£éƒ½æœ‰å…¶é…ç½®æ–‡ä»¶ã€‚æœåŠ¡å™¨çš„é»˜è®¤é…ç½®æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š

```
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=none
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=no
NAME=ens18
UUID=74c5ccee-c1f4-4f45-883f-fc4f765a8477
DEVICE=ens18
ONBOOT=yes
IPADDR=192.168.0.1
PREFIX=24
GATEWAY=192.168.0.254
DNS1=192.168.0.254
DNS2=1.1.1.1
IPV6_DISABLED=yes
```

æ¥å£çš„åç§°æ˜¯ **ens18**ï¼Œå› æ­¤è¯¥æ–‡ä»¶çš„åç§°å°†æ˜¯ `/etc/sysconfig/network-scripts/ifcfg-ens18`ã€‚

**æç¤ºï¼š** æœ‰å¤šç§æ–¹æ³•æˆ–æœºåˆ¶å¯ä»¥ä¸ºç³»ç»Ÿåˆ†é…å…¶ IP é…ç½®ä¿¡æ¯ã€‚æœ€å¸¸ç”¨çš„ä¸¤ç§æ–¹æ³•æ˜¯**é™æ€ IP é…ç½®**æ–¹æ¡ˆå’Œ**åŠ¨æ€ IP é…ç½®**æ–¹æ¡ˆã€‚

é™æ€ IP é…ç½®æ–¹æ¡ˆåœ¨æœåŠ¡å™¨ç±»ç³»ç»Ÿæˆ–ç½‘ç»œä¸Šéå¸¸å¸¸ç”¨ã€‚

åŠ¨æ€ IP æ–¹æ³•åœ¨å®¶åº­å’ŒåŠå…¬ç½‘ç»œæˆ–å·¥ä½œç«™å’Œå°å¼æœºç±»ç³»ç»Ÿä¸Šå¾ˆå¸¸ç”¨ã€‚åŠ¨æ€æ–¹æ¡ˆé€šå¸¸éœ€è¦æœ¬åœ°å¯ç”¨çš„é¢å¤–åè®®ï¼Œä»¥ä¾¿ä¸ºè¯·æ±‚çš„å·¥ä½œç«™å’Œå°å¼æœºæä¾›é€‚å½“çš„ IP é…ç½®ä¿¡æ¯ã€‚è¿™ç§åè®®å°±æ˜¯æ‰€è°“çš„åŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼ˆDHCPï¼‰ã€‚

é€šå¸¸ï¼Œå®¶åº­/åŠå…¬å®¤ç”¨æˆ·ä¸å¿…æ‹…å¿ƒæˆ–ä¸äº†è§£ DHCPã€‚è¿™æ˜¯å› ä¸ºæœ‰äººæˆ–å…¶ä»–ç¨‹åºä¼šåœ¨åå°è‡ªåŠ¨è¿›è¡Œå¤„ç†ã€‚æœ€ç»ˆç”¨æˆ·å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯é€šè¿‡ç‰©ç†æˆ–æ— çº¿è¿æ¥åˆ°æ­£ç¡®çš„ç½‘ç»œï¼ˆç¡®ä¿ç³»ç»Ÿå·²é€šç”µï¼‰ï¼

#### IP åœ°å€[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#ip)

åœ¨å‰é¢çš„ `/etc/sysconfig/network-scripts/ifcfg-ens18` æ–‡ä»¶ä¸­ï¼Œ`BOOTPROTO` å‚æ•°æˆ–é”®çš„å€¼è®¾ç½®ä¸º `none`ã€‚ è¿™æ„å‘³ç€å°†ç³»ç»Ÿè®¾ç½®ä¸ºé™æ€ IP åœ°å€æ–¹æ¡ˆã€‚

ç›¸åï¼Œå¦‚æœè¦å°†ç³»ç»Ÿé…ç½®ä¸ºä½¿ç”¨åŠ¨æ€ IP åœ°å€æ–¹æ¡ˆï¼Œåˆ™å¿…é¡»å°† `BOOTPROTO` å‚æ•°çš„å€¼ä» `none` æ›´æ”¹ä¸º `dhcp`ï¼Œå¹¶åˆ é™¤ `IPADDR`ã€ `PREFIX` å’Œ `GATEWAY` è¡Œã€‚è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºæ‰€æœ‰è¿™äº›ä¿¡æ¯éƒ½å°†ä»ä»»ä½•å¯ç”¨çš„ DHCP æœåŠ¡å™¨ä¸­è‡ªåŠ¨è·å¾—ã€‚

è¦é…ç½®é™æ€ IP åœ°å€å±æ€§ï¼Œè¯·è®¾ç½®ä»¥ä¸‹å†…å®¹ï¼š

- IPADDRï¼šåˆ†é…ç»™æ¥å£çš„ IP åœ°å€
- PREFIXï¼š[CIDR è¡¨ç¤ºæ³•](https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation)ä¸­çš„å­ç½‘æ©ç 
- GATEWAYï¼šé»˜è®¤ç½‘å…³

`ONBOOT` å‚æ•°è®¾ç½®ä¸º `yes`ï¼Œè¡¨ç¤ºæ­¤è¿æ¥å°†åœ¨ç³»ç»Ÿå¼•å¯¼æ—¶è¢«æ¿€æ´»ã€‚

#### DNS è§£æ[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#dns)

ä¸ºäº†è·å¾—æ­£ç¡®çš„åç§°è§£æï¼Œå¿…é¡»è®¾ç½®ä»¥ä¸‹å‚æ•°ï¼š

- DNS1ï¼šä¸»åç§°æœåŠ¡å™¨çš„ IP åœ°å€
- DNS2ï¼šè¾…åŠ©åç§°æœåŠ¡å™¨ IP åœ°å€

### åº”ç”¨é…ç½®[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_4)

è¦åº”ç”¨ç½‘ç»œé…ç½®ï¼Œå¯ä»¥ä½¿ç”¨ `nmcli` å‘½ä»¤ï¼š

```
nmcli connection up ens18
```

è¦è·å–è¿æ¥çŠ¶æ€ï¼Œåªéœ€ä½¿ç”¨ï¼š

```
nmcli connection show
```

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ `ifup` å’Œ `ifdown` å‘½ä»¤å¯¹è¯¥æ¥å£è¿›è¡Œå¼€å¯å’Œå…³é—­æ“ä½œï¼ˆå®ƒä»¬å¯¹ `nmcli` è¿›è¡Œç®€å•åŒ…è£…ï¼‰ï¼š

```
ifup ens18
ifdown ens18
```

### æ£€æŸ¥é…ç½®[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_5)

æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ `nmcli` å‘½ä»¤æ£€æŸ¥é…ç½®æ˜¯å¦å·²æ­£ç¡®åº”ç”¨ï¼š

```
nmcli device show ens18
```

å…¶è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š

```
GENERAL.DEVICE:                         ens18
GENERAL.TYPE:                           ethernet
GENERAL.HWADDR:                         6E:86:C0:4E:15:DB
GENERAL.MTU:                            1500
GENERAL.STATE:                          100 (connectÃ©)
GENERAL.CONNECTION:                     ens18
GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/1
WIRED-PROPERTIES.CARRIER:               marche
IP4.ADDRESS[1]:                         192.168.0.1/24
IP4.GATEWAY:                            192.168.0.254
IP4.ROUTE[1]:                           dst = 192.168.0.0/24, nh = 0.0.0.0, mt = 100
IP4.ROUTE[2]:                           dst = 0.0.0.0/0, nh = 192.168.0.254, mt = 100
IP4.DNS[1]:                             192.168.0.254
IP4.DNS[2]:                             1.1.1.1
IP6.GATEWAY:                            --
```

## ä½¿ç”¨ ip å‘½ä»¤[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#ip_1)

`ip` å‘½ä»¤ï¼ˆç”± *iproute2* è½¯ä»¶åŒ…æä¾›ï¼‰æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œå¯ç”¨äºè·å–ç½‘ç»œä¿¡æ¯å¹¶é…ç½®ç°ä»£ Linux ç³»ç»Ÿï¼ˆå¦‚ Rocky Linuxï¼‰çš„ç½‘ç»œã€‚

åœ¨ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œå‡å®šä»¥ä¸‹å‚æ•°ï¼š

- æ¥å£åç§°ï¼šens19
- IP åœ°å€ï¼š192.168.20.10
- å­ç½‘æ©ç ï¼š24
- ç½‘å…³ï¼š192.168.20.254

### è·å–å¸¸ç”¨ä¿¡æ¯[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_6)

è¦æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„è¯¦ç»†çŠ¶æ€ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ip a
```

**å®ç”¨æç¤º** * ä½¿ç”¨ `-c` æ ‡å¿—å¯è·å¾—æ›´å…·å¯è¯»æ€§çš„å½©è‰²è¾“å‡ºï¼š`ip -c a`ã€‚ * `ip`æ¥å—ç¼©å†™ï¼Œå› æ­¤ `ip a`ã€`ip addr` å’Œ `ip address` æ˜¯ç­‰æ•ˆçš„ã€‚

### å¼€å¯æˆ–å…³é—­æ¥å£[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_7)

è¦å¼€å¯ *ens19* æ¥å£ï¼Œåªéœ€ä½¿ç”¨ `ip link set ens19 up`ï¼Œè€Œè¦å…³é—­æ¥å£ï¼Œä½¿ç”¨ `ip link set ens19 down`ã€‚

### ä¸ºæ¥å£åˆ†é…é™æ€åœ°å€[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_8)

ä½¿ç”¨çš„å‘½ä»¤çš„æ ¼å¼ä¸ºï¼š

```
ip addr add <IP ADDRESS/CIDR> dev <IFACE NAME>
```

è¦åˆ†é…ä¸Šè¿°ç¤ºä¾‹å‚æ•°ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ip a add 192.168.20.10/24 dev ens19
```

ç„¶åï¼Œæ£€æŸ¥ç»“æœï¼š

```
ip a show dev ens19
```

å°†è¾“å‡ºä»¥ä¸‹å†…å®¹ï¼š

```
3: ens19: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 4a:f2:f5:b6:aa:9f brd ff:ff:ff:ff:ff:ff
    inet 192.168.20.10/24 scope global ens19
    valid_lft forever preferred_lft forever
```

æ¥å£å·²å¯åŠ¨å¹¶é…ç½®å®Œæ¯•ï¼Œä½†ä»ç„¶ç¼ºå°‘ä¸€äº›é…ç½®ï¼

### ä½¿ç”¨ ifcfg å‘½ä»¤[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#ifcfg)

è¦ç»™ *ens19* æ¥å£æ·»åŠ æ–°ç¤ºä¾‹ IP åœ°å€ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ifcfg ens19 add 192.168.20.10/24
```

åˆ é™¤ ip åœ°å€ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ifcfg ens19 del 192.168.20.10/24
```

è¦å®Œå…¨ç¦ç”¨æ­¤æ¥å£ä¸Šçš„ IP åœ°å€ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
ifcfg ens19 stop
```

*æ³¨æ„ï¼Œå®ƒä¸ä¼šå¯¼è‡´æ¥å£å…³é—­ï¼Œå®ƒåªæ˜¯ä»æ¥å£å–æ¶ˆåˆ†é…çš„æ‰€æœ‰ IP åœ°å€ã€‚*

### ç½‘å…³é…ç½®[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_9)

ç°åœ¨æ¥å£å·²æœ‰ä¸€ä¸ªåœ°å€ï¼Œæ¥ä¸‹æ¥å¿…é¡»è®¾ç½®å®ƒçš„é»˜è®¤è·¯ç”±ï¼Œè¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®Œæˆï¼š

```
ip route add default via 192.168.20.254 dev ens19
```

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ˜¾ç¤ºå†…æ ¸è·¯ç”±è¡¨ï¼š

```
ip route
```

ä»¥ä¸Šå¯ç®€å†™ä¸º `ip r`ã€‚

## æ£€æŸ¥ç½‘ç»œè¿æ¥[Â¶](https://docs.rockylinux.org/zh/guides/network/basic_network_configuration/#_10)

æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥å·²å¯åŠ¨å¹¶æ­£ç¡®é…ç½®äº†ç½‘ç»œæ¥å£ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥éªŒè¯æ‚¨çš„è¿æ¥ã€‚

é€šè¿‡ *pinging* åŒä¸€ç½‘ç»œä¸­çš„å¦ä¸€ä¸ª IP åœ°å€ï¼ˆæ­¤å¤„ä½¿ç”¨ `192.168.20.42` ä½œä¸ºç¤ºä¾‹ï¼‰ï¼š

```
ping -c3 192.168.20.42
```

æ­¤å‘½ä»¤å°†å‘å‡º 3 ä¸ª *ping*ï¼ˆç§°ä¸º ICMP è¯·æ±‚ï¼‰å¹¶ç­‰å¾…å›å¤ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ‚¨åº”è¯¥ä¼šå¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š

```
PING 192.168.20.42 (192.168.20.42) 56(84) bytes of data.
64 bytes from 192.168.20.42: icmp_seq=1 ttl=64 time=1.07 ms
64 bytes from 192.168.20.42: icmp_seq=2 ttl=64 time=0.915 ms
64 bytes from 192.168.20.42: icmp_seq=3 ttl=64 time=0.850 ms

--- 192.168.20.42 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 5ms
rtt min/avg/max/mdev = 0.850/0.946/1.074/0.097 ms
```

ç„¶åï¼Œä¸ºç¡®ä¿æ‚¨çš„è·¯ç”±é…ç½®æ­£ç¡®ï¼Œè¯·å°è¯• *ping* å¤–éƒ¨ä¸»æœºï¼Œä¾‹å¦‚ä¼—æ‰€å‘¨çŸ¥çš„å…¬å…± DNS è§£æå™¨ï¼š

```
ping -c3 8.8.8.8
```

å¦‚æœæ‚¨è®¡ç®—æœºæœ‰å¤šä¸ªç½‘ç»œæ¥å£ï¼Œä¸”æ‚¨å¸Œæœ›é€šè¿‡ç‰¹å®šæ¥å£å‘å‡º ICMP è¯·æ±‚ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ `-I` æ ‡å¿—ï¼š

```
ping -I ens19  -c3 192.168.20.42
```

æ¥ä¸‹æ¥ç¡®ä¿ DNS è§£ææ­£å¸¸å·¥ä½œã€‚æé†’ä¸€ä¸‹ï¼ŒDNS è§£ææ˜¯ä¸€ç§ç”¨äºå°†äººæ€§åŒ–çš„è®¡ç®—æœºåç§°è½¬æ¢ä¸º IP åœ°å€çš„æœºåˆ¶ï¼Œåä¹‹ç§°ä¸ºåå‘ DNSã€‚

å¦‚æœ `/etc/resolv.conf` æ–‡ä»¶æŒ‡ç¤ºå¯è®¿é—®çš„ DNS æœåŠ¡å™¨ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```
host rockylinux.org
```

ç»“æœåº”ä¸ºï¼š

```
rockylinux.org has address 76.76.21.21
```





å¯¹äºåˆæ¬¡ä½¿ç”¨GNU/Linuxçš„æ–°æ‰‹ç”¨æˆ·æ¥è¯´ï¼Œæœ€å…ˆè€ƒè™‘çš„äº‹æƒ…æ˜¯å®‰è£…æ“ä½œç³»ç»Ÿåå¦‚ä½•è®©æœºå™¨è¿æ¥äº’è”ç½‘ã€‚æœ¬ç¯‡å°†å‘Šè¯‰æ‚¨å¦‚ä½•é…ç½®IPåœ°å€ã€å­ç½‘æ©ç ã€ç½‘å…³ä»¥åŠDNSï¼Œæœ‰å‡ ç§æ–¹å¼ä½œä¸ºå‚è€ƒï¼Œä¸ç®¡æ˜¯æ–°æ‰‹è¿˜æ˜¯ç†Ÿæ‰‹ï¼Œç›¸ä¿¡æ‚¨éƒ½éƒ½èƒ½å¿«é€Ÿä¸Šæ‰‹ã€‚

## nmtui[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#nmtui)

`NetworkManager`æ˜¯æ ‡å‡† Linux ç½‘ç»œé…ç½®å·¥å…·å¥—ä»¶ï¼Œæ”¯æŒæœåŠ¡å™¨ï¼Œä¹Ÿæ”¯æŒæ¡Œé¢ç¯å¢ƒï¼Œå‘å±•åˆ°å¦‚ä»Šï¼Œç»å¤§å¤šæ•°æµè¡Œçš„å‘è¡Œç‰ˆéƒ½æ”¯æŒå®ƒã€‚è¿™å¥—ç½‘ç»œé…ç½®å·¥å…·é€‚ç”¨äº Rocky Linux 8 åŠæ›´é«˜ç‰ˆæœ¬ï¼Œå¦‚æœæ‚¨å¸Œæœ›å›¾å½¢åŒ–çš„æ–¹å¼é…ç½®ç½‘ç»œä¿¡æ¯ï¼ˆå³å‘½ä»¤è¡Œ`nmtui`ï¼‰ï¼Œåªéœ€è¦è¿™ä¹ˆåšï¼š

```
shell > dnf -y install NetworkManager NetworkManager-tui
shell > nmtui
```

| NetworkManager TUI    |       |
| --------------------- | ----- |
| Edit a connection     |       |
| Activate a connection |       |
| Set system hostname   |       |
| Quit                  |       |
|                       | \<OK> |

æ‚¨å¯ä»¥ä½¿ç”¨ Tabé”® æˆ–è€… â†‘â†“â†â†’é”®çš„æ–¹å¼é€‰æ‹©å…·ä½“çš„åŠŸèƒ½ï¼Œå¦‚æœè¦æ›´æ”¹ç½‘ç»œä¿¡æ¯ï¼Œè¯·é€‰æ‹© **Edit a connection** ï¼Œç„¶åEnteré”®ã€‚é€‰æ‹©ä¸åŒçš„ç½‘å¡ï¼Œé€‰æ‹© **Edit..** è¿›è¡Œç¼–è¾‘ã€‚

### DHCPçš„IPv4[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#dhcpipv4)

é’ˆå¯¹IPv4ï¼Œå¦‚æœæ˜¯ä½¿ç”¨DHCPçš„æ–¹å¼è·å–ç½‘ç»œä¿¡æ¯ï¼Œåˆ™åªéœ€è¦é€‰æ‹© *IPv4 CONFIGURATION* åé¢çš„  **<Automatic>** ï¼Œç„¶ååœ¨æ‚¨çš„ç»ˆç«¯ä¸­è¿è¡Œä¸‹`systemctl restart NetworkManager.service`ï¼Œå¤§å¤šæ•°çš„æƒ…å†µä¸‹éƒ½èƒ½ç”Ÿæ•ˆï¼Œæå°‘æ•°çš„æƒ…å†µä¸‹éœ€è¦å¼€å…³ç½‘å¡æ‰èƒ½ç”Ÿæ•ˆï¼Œä¾‹å¦‚è¿™æ ·çš„æ–¹å¼â€”â€”`nmcli connection down ens33`ï¼Œ`nmcli connection up ens33`

### æ‰‹åŠ¨å›ºå®šç½‘ç»œä¿¡æ¯[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#_2)

å¦‚æœè¦å°†æ‰€æœ‰IPv4çš„ç½‘ç»œä¿¡æ¯è¿›è¡Œæ‰‹åŠ¨å›ºå®šï¼Œéœ€è¦é€‰æ‹© *IPv4 CONFIGURATION* åé¢çš„ **<Manual>**ï¼Œä¸€è¡Œä¸€è¡Œè¿›è¡Œæ·»åŠ ï¼Œä¾‹å¦‚æˆ‘è¿™æ ·çš„ï¼š

| é¡¹          | å€¼               |
| ----------- | ---------------- |
| Addresses   | 192.168.100.4/24 |
| Gateway     | 192.168.100.1    |
| DNS servers | 8.8.8.8          |

ç„¶åç‚¹å‡» \<OK> ï¼Œä¸€æ­¥ä¸€æ­¥è¿”å›åˆ°ç»ˆç«¯ç•Œé¢ï¼Œæ‰§è¡Œ`systemctl restart NetworkManager.service` å³å¯ã€‚åŒæ ·çš„ï¼Œæå°‘æ•°çš„æƒ…å†µä¸‹éœ€è¦å¼€å…³ç½‘å¡æ‰èƒ½ç”Ÿæ•ˆã€‚

## æ›´æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#_3)

æ‰€æœ‰çš„RHELå‘è¡Œç‰ˆï¼Œä¸ç®¡æ˜¯ä¸Šæ¸¸çš„è¿˜æ˜¯ä¸‹æ¸¸çš„ï¼Œéƒ½æ˜¯ä¸€æ ·çš„é…ç½®æ–¹å¼ã€‚ç½‘ç»œä¿¡æ¯çš„é…ç½®æ–‡ä»¶ä¿å­˜åœ¨ **/etc/sysconfig/network-scripts/** ç›®å½•ä¸‹é¢ï¼Œä¸€ä¸ªç½‘å¡å¯¹åº”ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶çš„å‚æ•°éå¸¸çš„å¤šï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚æ³¨æ„ï¼å‚æ•°ä¸€å®šè¦å¤§å†™ã€‚

```
shell > ls /etc/sysconfig/network-scripts/
ifcfg-ens33
```

| å‚æ•°å             | å«ä¹‰                                                         | ç¤ºä¾‹                              |
| ------------------ | ------------------------------------------------------------ | --------------------------------- |
| DEVICE             | ç³»ç»Ÿé€»è¾‘è®¾å¤‡å                                               | DEVICE=ens33                      |
| ONBOOT             | ç½‘å¡æ˜¯å¦éšç³»ç»Ÿè‡ªå¯åŠ¨ï¼Œå¯é€‰æ‹©yesæˆ–è€…no                        | ONBOOT=yes                        |
| TYPE               | ç½‘å¡æ¥å£ç±»å‹ï¼Œä¸€èˆ¬æ˜¯Ethernet                                 | TYPE=Ethernet                     |
| BOOTPROTO          | è·å–ipçš„æ–¹å¼ï¼Œå¯ä»¥æ˜¯DHCPåŠ¨æ€è·å–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨staticé™æ€æ‰‹åŠ¨é…ç½® | BOOTPROTO=static                  |
| IPADDR             | ç½‘å¡çš„ipåœ°å€ï¼Œå½“BOOTPROTO=staticæ—¶ï¼Œè¯¥å‚æ•°æ‰ç”Ÿæ•ˆ             | IPADDR=192.168.100.4              |
| HWADDR             | ç¡¬ä»¶åœ°å€ï¼Œå³MACåœ°å€                                          | HWADDR=00:0C:29:84:F6:9C          |
| NETMASK            | åè¿›åˆ¶çš„å­ç½‘æ©ç                                              | NETMASK=255.255.255.0             |
| PREFIX             | å­ç½‘æ©ç ï¼Œç”¨æ•°å­—è¡¨ç¤ºçš„æ–¹å¼                                   | PREFIX=24                         |
| GATEWAY            | ç½‘å…³ï¼Œè‹¥æœ‰å¤šå—ç½‘å¡ï¼Œè¯¥å‚æ•°åªèƒ½å‡ºç°ä¸€æ¬¡                       | GATEWAY=192.168.100.1             |
| PEERDNS            | å½“ä¸ºyesæ—¶ï¼Œæ­¤å¤„å®šä¹‰çš„DNSå‚æ•°ä¼šä¿®æ”¹/etc/resolv.confï¼›å½“ä¸ºnoæ—¶ï¼Œä¸ä¼šä¿®æ”¹/etc/resolv.confã€‚å½“ä½¿ç”¨DHCPæ—¶ï¼Œæ­¤å¤„é»˜è®¤yes | PEERDNS=yes                       |
| DNS1               | ä¸»é€‰DNSï¼Œå½“PEERDNS=noæ—¶æ‰ç”Ÿæ•ˆ                                | DNS1=8.8.8.8                      |
| DNS2               | å¤‡é€‰DNSï¼Œå½“PEERDNS=noæ—¶æ‰ç”Ÿæ•ˆ                                | DNS2=114.114.114.114              |
| BROWSER_ONLY       | æ˜¯å¦åªå…è®¸æµè§ˆå™¨                                             | BROWSER_ONLY=no                   |
| USERCTL            | æ˜¯å¦å…è®¸æ™®é€šç”¨æˆ·æ§åˆ¶ç½‘å¡è®¾å¤‡ï¼Œyesè¡¨ç¤ºå…è®¸ï¼Œnoè¡¨ç¤ºä¸å…è®¸      | USERCTL=no                        |
| UUID               | é€šç”¨å”¯ä¸€è¯†åˆ«ç ï¼Œä¸»è¦ä½œç”¨æ˜¯æ ‡è¯†ç¡¬ä»¶ï¼Œä¸€èˆ¬æ¥è¯´å¯ä¸å¡«           |                                   |
| PROXY_METHOD       | ä»£ç†çš„æ–¹å¼ï¼Œä¸€èˆ¬ä¸ºnoneï¼Œå¯ä¸å¡«                               |                                   |
| IPV4_FAILURE_FATAL | å¦‚æœä¸ºyesï¼Œè¡¨ç¤ºipv4é…ç½®å¤±è´¥åç¦ç”¨è®¾å¤‡ï¼›ä¸ºnoï¼Œè¡¨ç¤ºä¸ç¦ç”¨ã€‚    | IPV4_FAILURE_FATAL=no             |
| IPV6INIT           | æ˜¯å¦å¯ç”¨IPV6ï¼Œyeså¯ç”¨ï¼Œnoä¸å¯ç”¨ã€‚å½“IPV6INIT=yesæ—¶ï¼Œè¿˜èƒ½å¯ç”¨ IPV6ADDR ä¸  IPV6_DEFAULTGW ä¸¤ä¸ªå‚æ•°ï¼Œå‰è€…è¡¨ç¤ºIPV6åœ°å€ï¼Œåè€…è¡¨ç¤ºæŒ‡å®šç½‘å…³ | IPV6INIT=yes                      |
| IPV6_AUTOCONF      | æ˜¯å¦ä½¿ç”¨IPV6çš„è‡ªåŠ¨é…ç½®ï¼Œyesè¡¨ç¤ºä½¿ç”¨ï¼›noè¡¨ç¤ºä¸ä½¿ç”¨            | IPV6_AUTOCONF=yes                 |
| IPV6_DEFROUTE      | æ˜¯å¦ç»™IPV6é»˜è®¤è·¯ç”±                                           | IPV6_DEFROUTE=yes                 |
| IPV6_FAILURE_FATAL | IPV6é…ç½®å¤±è´¥åï¼Œæ˜¯å¦ç¦ç”¨è®¾å¤‡                                 | IPV6_FAILURE_FATAL=no             |
| IPV6_ADDR_GEN_MODE | äº§ç”ŸIPV6åœ°å€çš„æ¨¡å‹ï¼Œå¯é€‰å€¼æœ‰stable-privacyä¸eui64            | IPV6_ADDR_GEN_MODE=stable-privacy |

é…ç½®æ–‡ä»¶ä¿®æ”¹æˆåŠŸåï¼Œè®°å¾—é‡å¯ç½‘å¡æœåŠ¡`systemctl restart NetworkManager.service`

### IPV4çš„æ¨èé…ç½®[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#ipv4)

```
TYPE=Ethernet
ONBOOT=yes
DEVICE=ens33
USERCTL=no
IPV4_FAILURE_FATAL=no
BROWSER_ONLY=no
BOOTPROTO=static
PEERDNS=no
IPADDR=192.168.100.4
PREFIX=24
GATEWAY=192.168.100.1
DNS1=8.8.8.8
DNS2=114.114.114.114
```

### IPV6çš„æ¨èé…ç½®[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#ipv6)

```
TYPE=Ethernet
ONBOOT=yes
DEVICE=ens33
USERCTL=no
BROWSER_ONLY=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
```

## æŸ¥çœ‹ç½‘ç»œä¿¡æ¯[Â¶](https://docs.rockylinux.org/zh/gemstones/nmtui/#_4)

```
ip a`æˆ–è€…`nmcli device show
```

Author: tianci li

Contributors: Steven Spencer, Neil Hanlon